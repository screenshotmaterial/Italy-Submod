HOL_restore_exiled_netherlands = {
	every_owned_state = {
		limit = {
			NOT = {
				is_on_continent = asia
				is_core_of = DEI
				is_core_of = INS
			}
		}
		transfer_state_to = HOL
	}
	HOL = { drop_cosmetic_tag = yes }
	hidden_effect = {
		if = {
			limit = { is_in_faction = yes }
			faction_leader = {
				add_to_faction = HOL
				if = {
					limit = { tag = GER }
					HOL = { GER_add_to_mitteleuropa = yes }
				}
			}
		}
		HOL = {
			transfer_technology_without_doctrines = yes
			drop_cosmetic_tag = yes
			set_politics = {
				ruling_party = authoritarian_democrat
				elections_allowed = no
			}
			set_popularities = {
				totalist = 0
				syndicalist = 0
				radical_socialist = 0
				social_democrat = 20
				social_liberal = 10
				market_liberal = 5
				social_conservative = 25
				authoritarian_democrat = 40
				paternal_autocrat = 0
				national_populist = 0
			}
			remove_all_ministers = yes
			add_ideas = {
				HOL_Graaf_de_Marchant_et_d'Ansembourg_hog_ade
				HOL_Henri_Johannes_ter_Hal_eco_pau
				HOL_Frans_B_van_Blokland_for_ade
				HOL_Louis_Einthoven_sec_ade
			}
			#Clean slate
			complete_national_focus = HOL_reijnders_putsch #Junta path, so you can restore democracy afterwards
			complete_national_focus = HOL_junta_consolidation
		}
		transfer_navy = { target = HOL }
	}
}

HOL_remove_monarchy = {
	if = {
		limit = { has_character = HOL_wilhelmina_van_orange_nassau }
		effect_tooltip = { retire_character = HOL_wilhelmina_van_orange_nassau }
		hidden_effect = { event_target:HOL_wilhelmina_van_orange_nassau_target = { set_nationality = XXA } }
	}
	if = {
		limit = { has_character = HOL_juliana_van_orange_nassau }
		effect_tooltip = { retire_character = HOL_juliana_van_orange_nassau }
		hidden_effect = { event_target:HOL_juliana_van_orange_nassau_target = { set_nationality = XXA } }
	}
}

HOL_create_wilhelmina = {
	if = {
		limit = { has_event_target = HOL_wilhelmina_van_orange_nassau_target }
		event_target:HOL_wilhelmina_van_orange_nassau_target = {
			set_nationality = PREV
		}
		hidden_effect = {
			if = {
				limit = { has_character = HOL_wilhelmina_van_orange_nassau }
				HOL_wilhelmina_van_orange_nassau = {
					if = {
						limit = { has_ideology = social_democrat_subtype }
						promote_character = { ideology = social_democrat_subtype }
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = social_democrat_subtype
							}
							promote_leader = yes
						}
					}
					if = {
						limit = { has_ideology = social_liberal_subtype }
						promote_character = { ideology = social_liberal_subtype }
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = social_liberal_subtype
							}
							promote_leader = yes
						}
					}
					if = {
						limit = { has_ideology = market_liberal_subtype }
						promote_character = { ideology = market_liberal_subtype }
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = market_liberal_subtype
							}
							promote_leader = yes
						}
					}
					if = {
						limit = { has_ideology = social_conservative_subtype }
						promote_character = { ideology = social_conservative_subtype }
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = social_conservative_subtype
							}
							promote_leader = yes
						}
					}
					if = {
						limit = { has_ideology = authoritarian_democrat_subtype }
						promote_character = { ideology = authoritarian_democrat_subtype }
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = authoritarian_democrat_subtype
							}
							promote_leader = yes
						}
					}
					if = {
						limit = { has_ideology = paternal_autocrat_subtype }
						promote_character = { ideology = paternal_autocrat_subtype }
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = paternal_autocrat_subtype
							}
							promote_leader = yes
						}
					}
					if = {
						limit = { has_ideology = national_populist_subtype }
						promote_character = { ideology = national_populist_subtype }
					}
					else = {
						add_country_leader_role = {
							country_leader = {
								ideology = national_populist_subtype
							}
							promote_leader = yes
						}
					}
				}
			}
		}
	}
	else = {
		HOL_create_juliana = yes
	}
}

HOL_create_juliana = {
	event_target:HOL_juliana_van_orange_nassau_target = {
		set_nationality = PREV
		set_character_name = "Juliana"
	}
	if = {
		limit = { has_character = HOL_juliana_van_orange_nassau }
		HOL_juliana_van_orange_nassau = {
			if = {
				limit = { has_ideology = social_democrat_subtype }
				promote_character = { ideology = social_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = social_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_liberal_subtype }
				promote_character = { ideology = social_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = social_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = market_liberal_subtype }
				promote_character = { ideology = market_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = market_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_conservative_subtype }
				promote_character = { ideology = social_conservative_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = social_conservative_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = authoritarian_democrat_subtype }
				promote_character = { ideology = authoritarian_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = authoritarian_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = paternal_autocrat_subtype }
				promote_character = { ideology = paternal_autocrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = paternal_autocrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = national_populist_subtype }
				promote_character = { ideology = national_populist_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						ideology = national_populist_subtype
					}
					promote_leader = yes
				}
			}
		}
	}
}

HOL_DEI_is_annexed = {
	hidden_effect = {
		every_state = {
			limit = { is_core_of = DEI }
			remove_core_of = DEI
		}
		DEI = {
			transfer_navy = { target = PREV }
			every_character = {
				limit = { has_character_flag = HOL_leader }
				set_nationality = PREV
			}
		}
		annex_country = {
			target = DEI
			transfer_troops = yes
		}
	}
	HOL_DEI_is_restored = yes
}

HOL_DEI_is_restored = {
	hidden_effect = {
		if = {
			limit = { country_exists = DEI }
			HOL = {
				set_autonomy = {
					target = DEI
					autonomy_state = kr_default_puppet
					end_wars = no
				}
			}
		}
		DEI = {
			set_politics = {
				ruling_party = authoritarian_democrat
				last_election = "1935.11.14"
				election_frequency = 48
				elections_allowed = no
			}
			set_popularities = {
				totalist = 0
				radical_socialist = 0
				syndicalist = 0
				social_democrat = 0
				social_liberal = 4
				market_liberal = 10
				social_conservative = 5
				authoritarian_democrat = 56
				paternal_autocrat = 25
				national_populist = 0
			}
			HOL_remove_monarchy = yes
			if = {
				limit = { NOT = { has_country_leader = { character = DEI_alidius_tjarda_van_starkenborgh_stachouwer } } }
				DEI_alidius_tjarda_van_starkenborgh_stachouwer = { promote_character = yes }
			}
			set_country_flag = dei_long_name_appointed
			clr_country_flag = dei_palar_appointed
			clr_country_flag = holex_got_exiled
			clr_country_flag = dei_furstner_appointed
			mark_focus_tree_layout_dirty = yes
			if = {
				limit = { has_variable = DEI_original_army_idea }
				add_ideas = var:DEI_original_army_idea
				clear_variable = DEI_original_army_idea
			}
		}
	}
}

HOL_remove_socialist_ideas = {
	remove_ideas = HOL_idea_transition_to_fair_economy
	if = {
		limit = { has_idea = HOL_idea_batavian_courage }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_idea_batavian_courage }
		remove_ideas = HOL_idea_batavian_courage
	}
	else_if = {
		limit = { has_idea = HOL_idea_batavian_courage_1 }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_idea_batavian_courage_1 }
		remove_ideas = HOL_idea_batavian_courage_1
	}
	else_if = {
		limit = { has_idea = HOL_idea_batavian_courage_2 }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_idea_batavian_courage_2 }
		remove_ideas = HOL_idea_batavian_courage_2
	}
	if = {
		limit = { has_idea = HOL_Red_Sky }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_Red_Sky }
		remove_ideas = HOL_Red_Sky
	}
	else_if = {
		limit = { has_idea = HOL_Red_Sky_1 }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_Red_Sky_1 }
		remove_ideas = HOL_Red_Sky_1
	}
	if = {
		limit = { has_idea = HOL_british_designs_tanks }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_british_designs_tanks }
		remove_ideas = HOL_british_designs_tanks
	}
	if = {
		limit = { has_idea = HOL_red_navy }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_red_navy }
		remove_ideas = HOL_red_navy
	}
	else_if = {
		limit = { has_idea = HOL_red_navy_1 }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_red_navy_1 }
		remove_ideas = HOL_red_navy_1
	}
	else_if = {
		limit = { has_idea = HOL_red_navy_2 }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_red_navy_2 }
		remove_ideas = HOL_red_navy_2
	}
	if = {
		limit = { has_idea = HOL_syn_rebuilding_idea }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_syn_rebuilding_idea }
		remove_ideas = HOL_syn_rebuilding_idea
	}
	else_if = {
		limit = { has_idea = HOL_Proletarian_humanism_idea }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_Proletarian_humanism_idea }
		remove_ideas = HOL_Proletarian_humanism_idea
	}
	else_if = {
		limit = { has_idea = HOL_Proletarian_humanism_idea_final }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_Proletarian_humanism_idea_final }
		remove_ideas = HOL_Proletarian_humanism_idea_final
	}
	else_if = {
		limit = { has_idea = HOL_Industrial_Dem_idea }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_Industrial_Dem_idea }
		remove_ideas = HOL_Industrial_Dem_idea
	}
	else_if = {
		limit = { has_idea = HOL_Industrial_Dem_idea_final }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_Industrial_Dem_idea_final }
		remove_ideas = HOL_Industrial_Dem_idea_final
	}
	else_if = {
		limit = { has_idea = HOL_rev_vanguard_idea }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_rev_vanguard_idea }
		remove_ideas = HOL_rev_vanguard_idea
	}
	else_if = {
		limit = { has_idea = HOL_rev_vanguard_idea_final }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_rev_vanguard_idea_final }
		remove_ideas = HOL_rev_vanguard_idea_final
	}
	else_if = {
		limit = { has_idea = HOL_rev_vanguard_idea_final }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_rev_vanguard_idea_final }
		remove_ideas = HOL_rev_vanguard_idea_final
	}
	else_if = {
		limit = { has_idea = HOL_idea_democratic_workplace }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_idea_democratic_workplace }
		remove_ideas = HOL_idea_democratic_workplace
	}
	else_if = {
		limit = { has_idea = HOL_idea_democratic_workplace_final }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_idea_democratic_workplace_final }
		remove_ideas = HOL_idea_democratic_workplace_final
	}
	if = {
		limit = { has_idea = HOL_Rebuild_The_Bureaucracy_idea }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_Rebuild_The_Bureaucracy_idea }
		remove_ideas = HOL_Rebuild_The_Bureaucracy_idea
	}
	if = {
		limit = { has_idea = HOL_idea_mass_collectivisation }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_idea_mass_collectivisation }
		remove_ideas = HOL_idea_mass_collectivisation
	}
	if = {
		limit = { has_idea = HOL_idea_verzorgingsstaat }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_idea_verzorgingsstaat }
		remove_ideas = HOL_idea_verzorgingsstaat
	}
	if = {
		limit = { has_idea = HOL_idea_market_socialism }
		add_to_array = { HOL_socialist_ideas_to_restore = token:HOL_idea_market_socialism }
		remove_ideas = HOL_idea_market_socialism
	}
}

HOL_add_socialist_ideas = {
	if = {
		limit = { check_variable = { HOL_socialist_ideas_to_restore^num > 0 } }
		for_each_loop = {
			array = HOL_socialist_ideas_to_restore
			if = {
				limit = { NOT = { has_idea = var:v } }
				add_ideas = var:v
			}
		}
		clear_array = HOL_socialist_ideas_to_restore
	}
}

HOL_puppet_setup = {
	hidden_effect = {
		if = {
			limit = { country_exists = DEI }
			DEI = { country_event = holex.39 }
		}
		HOL = {
			if = {
				limit = { has_government = syndicalist }
				random_list = {
					40 = { HOL_anton_pannekoek = { promote_character = yes } } #== puppet KAPN instead of NAS
					60 = { HOL_jacques_de_kadt = { promote_character = yes } }
				}
			}
			else_if = {
				limit = { has_government = social_democrat }
				unlock_national_focus = HOL_left_list_victorious
				unlock_national_focus = HOL_VDB_SDAP
			}
			else_if = {
				limit = { has_government = social_liberal }
				unlock_national_focus = HOL_left_list_victorious
				unlock_national_focus = HOL_work_with_LSP
			}
			else_if = {
				limit = { has_government = social_conservative }
				unlock_national_focus = HOL_CNA_gamble_worked
				unlock_national_focus = HOL_CNA_on_its_own
			}
			else_if = {
				limit = { has_government = authoritarian_democrat }
				unlock_national_focus = HOL_reijnders_putsch
				unlock_national_focus = HOL_junta_consolidation
			}
			else_if = {
				limit = { has_dictatorship_government = yes }
				unlock_national_focus = HOL_VNH_victory
				unlock_national_focus = HOL_intimidate_parliament
			}
		}
	}
}

HOL_calculate_assembly_results = {
	hidden_effect = {
		if = {
			limit = { check_variable = { HOL_assembly_patriotten > 2 } }
			country_event = { id = holfocus.62 days = 10 }
		}
		else_if = {
			limit = { check_variable = { HOL_assembly_nas > 2 } }
			country_event = { id = holfocus.63 days = 10 }
		}
		else_if = {
			limit = { check_variable = { HOL_assembly_rsap > 2 } }
			country_event = { id = holfocus.64 days = 10 }
		}
		else_if = {
			limit = { check_variable = { HOL_assembly_sdap > 2 } }
			country_event = { id = holfocus.65 days = 10 }
		}
		else_if = {
			limit = { check_variable = { HOL_assembly_kapn > 2 } }
			country_event = { id = holfocus.95 days = 10 }
		}
		else = {
			country_event = { id = holfocus.66 days = 10 }
		}
	}
}
