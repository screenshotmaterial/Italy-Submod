SAF_reform_segregation_1 = {
	if = {
		limit = {
			NOT = {
				AND = {
					has_authoritarian_government = yes
					has_completed_focus = SAF_implement_apartheid
				}
			}
		}
		modify_country_flag = { flag = SAF_segregation_reform value = 1 }
		if = {
			limit = { has_idea = SAF_segregation_1 }
			swap_ideas = {
				remove_idea = SAF_segregation_1
				add_idea = SAF_segregation_2
			}
		}
		else_if = {
			limit = { has_idea = SAF_segregation_2 }
			swap_ideas = {
				remove_idea = SAF_segregation_2
				add_idea = SAF_segregation_3
			}
		}
		else_if = {
			limit = { has_idea = SAF_segregation_3 }
			swap_ideas = {
				remove_idea = SAF_segregation_3
				add_idea = SAF_segregation_4
			}
		}
		else_if = {
			limit = { has_idea = SAF_segregation_4 }
			swap_ideas = {
				remove_idea = SAF_segregation_4
				add_idea = SAF_segregation_5
			}
		}
		else_if = {
			limit = { has_idea = SAF_segregation_5 }
			swap_ideas = {
				remove_idea = SAF_segregation_5
				add_idea = SAF_segregation_6
			}
		}
	}
}

SAF_increase_segregation_1 = {
	if = {
		limit = {
			NOT = {
				AND = {
					has_authoritarian_government = yes
					has_completed_focus = SAF_implement_apartheid
				}
			}
		}
		modify_country_flag = { flag = SAF_segregation_reform value = -1 }
		if = {
			limit = { has_idea = SAF_segregation_6 }
			swap_ideas = {
				remove_idea = SAF_segregation_6
				add_idea = SAF_segregation_5
			}
		}
		else_if = {
			limit = { has_idea = SAF_segregation_5 }
			swap_ideas = {
				remove_idea = SAF_segregation_5
				add_idea = SAF_segregation_4
			}
		}
		else_if = {
			limit = { has_idea = SAF_segregation_4 }
			swap_ideas = {
				remove_idea = SAF_segregation_4
				add_idea = SAF_segregation_3
			}
		}
		else_if = {
			limit = { has_idea = SAF_segregation_3 }
			swap_ideas = {
				remove_idea = SAF_segregation_3
				add_idea = SAF_segregation_2
			}
		}
		else_if = {
			limit = { has_idea = SAF_segregation_2 }
			swap_ideas = {
				remove_idea = SAF_segregation_2
				add_idea = SAF_segregation_1
			}
		}
	}
}

SAF_inflation_events = {
	hidden_effect = {
		country_event = { id = saf.162 days = 2 random_days = 4 }
		country_event = { id = saf.163 days = 2 random_days = 4 }
	}
}

SAF_puppet_setup = {
	if = {
		limit = { has_democratic_government = no }
		var:tag_to_release = {
			set_politics = {
				ruling_party = var:SAF.current_party_ideology_group
				elections_allowed = no
			}
		}
	}
	hidden_effect = {
		if = { #Native South Africa
			limit = {
				OR = {
					has_socialist_government = yes
					is_in_africa = yes
					is_in_asia = yes
					is_in_india = yes
					is_in_middle_east = yes
					original_tag = HAI
				}
				NOT = {
					tag = GEO
					tag = ARM
					tag = NFA
					tag = MAF
					tag = RAJ
					tag = DEI
					tag = GEA
					tag = LEC
				}
			}
			var:tag_to_release = {
				SAF_remove_governor_general = yes
				SAF_promote_native_republican_leaders = yes
				SAF_add_socialist_generals = yes
				SAF_remove_entente_generals = yes
				if = {
					limit = {
						has_socialist_government = yes
						NOT = { has_focus_tree = SAF_socialist_focus }
					}
					load_focus_tree = { tree = SAF_socialist_focus keep_completed = yes }
					add_ideas = {
						SAF_idea_reactionary_activities
						SAF_idea_low_participation
					}
				}
			}
		}
		else_if = { #British puppet - South African Federation
			limit = { is_ally_with = ENT }
			var:tag_to_release = {
				set_cosmetic_tag = SAF_federation
				set_politics = {
					ruling_party = paternal_autocrat
					elections_allowed = no
				}
				add_popularity = {
					ideology = paternal_autocrat
					popularity = 0.3
				}
				SAF_promote_white_republican_leaders = yes
				SAF_federation_party_names = yes
				SAF_create_governor_general = yes
				SAF_add_entente_generals = yes
				SAF_remove_socialist_generals = yes
				load_focus_tree = { tree = SAF_federation_focus keep_completed = yes }
				SAF_remove_socialist_ideas = yes
			}
		}
		else_if = { #Dutch/German puppet - South African Republic
			limit = {
				OR = {
					original_tag = HOL
					is_ally_with = GER
				}
			}
			var:tag_to_release = {
				set_cosmetic_tag = SAF_republic_puppet
				set_politics = {
					ruling_party = paternal_autocrat
					elections_allowed = no
				}
				add_popularity = {
					ideology = paternal_autocrat
					popularity = 0.3
				}
				SAF_remove_governor_general = yes
				SAF_promote_white_republican_leaders = yes
				SAF_union_party_names = yes
				SAF_add_socialist_generals = yes
				SAF_remove_entente_generals = yes
				load_focus_tree = { tree = SAF_focus keep_completed = yes }
				SAF_remove_socialist_ideas = yes
			}
		}
		else = {  #If you don't fulfill the above conditions you're a non-aligned western nation. Just make it a white republic then without shenanigans
			var:tag_to_release = {
				set_cosmetic_tag = SAF_union_no_brits
				SAF_remove_governor_general = yes
				SAF_promote_white_republican_leaders = yes
				SAF_union_party_names = yes
				SAF_add_entente_generals = yes
				SAF_remove_socialist_generals = yes
				load_focus_tree = { tree = SAF_focus keep_completed = yes }
				SAF_remove_socialist_ideas = yes
			}
		}
	}
}

SAF_remove_socialist_ideas = {
	remove_ideas = {
		SAF_idea_converting_to_socialism
		SAF_idea_converting_to_socialism_1
		SAF_idea_converting_to_socialism_2
		SAF_idea_syndicalist_economy
		SAF_idea_native_republic
		SAF_idea_slum_formation
		SAF_idea_slum_formation_2
		SAF_idea_reactionary_activities
		SAF_idea_reactionary_activities_1
		SAF_idea_low_participation
		SAF_idea_low_participation_1
		SAF_idea_native_trade_unions
		SAF_idea_native_education
		SAF_idea_dismantling_tribal_structures
		SAF_idea_ethnic_rep_councils
		SAF_idea_white_flight
		SAF_idea_new_farmers
	}
	remove_targeted_decision = { target = SAF decision = SAF_decision_township_modernisation }
	if = {
		limit = {
			NOT = {
				has_idea = SAF_segregation_1
				has_idea = SAF_segregation_2
				has_idea = SAF_segregation_3
				has_idea = SAF_segregation_4
				has_idea = SAF_segregation_5
				has_idea = SAF_segregation_6
			}
		}
		add_ideas = SAF_segregation_3
	}
}

SAF_promote_native_republican_leaders = {
	SAF_james_arnold_la_guma = {
		set_nationality = PREV
		promote_character = { ideology = totalist_subtype }
	}
	SAF_clements_kadalie = {
		set_nationality = PREV
		promote_character = { ideology = syndicalist_subtype }
	}
	SAF_moses_mauane_kotane = {
		set_nationality = PREV
		promote_character = { ideology = radical_socialist_subtype }
	}
	SAF_josiah_tshangana_gumede = {
		set_nationality = PREV
		promote_character = { ideology = social_democrat_subtype }
	}
	SAF_davidson_don_tengo_jabavu = {
		set_nationality = PREV
		promote_character = { ideology = social_liberal_subtype }
		promote_character = { ideology = market_liberal_subtype }
	}
	SAF_alfred_bitini_xuma = {
		set_nationality = PREV
		promote_character = { ideology = social_conservative_subtype }
		promote_character = { ideology = authoritarian_democrat_subtype }
	}
	SAF_anton_muziwakhe_lembede = {
		set_nationality = PREV
		promote_character = { ideology = paternal_autocrat_subtype }
		promote_character = { ideology = national_populist_subtype }
	}
	set_party_name = { ideology = radical_socialist name = SAF_party_ANC long_name = SAF_party_ANC_socialists }
	set_party_name = { ideology = social_democrat name = SAF_party_ANC long_name = SAF_party_ANC_socialists }
	set_party_name = { ideology = social_liberal name = SAF_party_ANC long_name = SAF_party_ANC_liberal }
	set_party_name = { ideology = market_liberal name = SAF_party_ANC long_name = SAF_party_ANC_liberal }
	set_party_name = { ideology = social_conservative name = SAF_party_ANC long_name = SAF_party_ANC_conservatives }
	set_party_name = { ideology = authoritarian_democrat name = SAF_party_ANC long_name = SAF_party_ANC_conservatives }
	set_party_name = { ideology = paternal_autocrat name = SAF_party_ANC long_name = SAF_party_ANC_nationalists }
	set_party_name = { ideology = national_populist name = SAF_party_ANC long_name = SAF_party_ANC_nationalists }
}

SAF_promote_white_republican_leaders = {
	SAF_james_arnold_la_guma = {
		set_nationality = PREV
		promote_character = { ideology = totalist_subtype }
	}
	SAF_clements_kadalie = {
		set_nationality = PREV
		promote_character = { ideology = syndicalist_subtype }
	}
	SAF_moses_mauane_kotane = {
		set_nationality = PREV
		promote_character = { ideology = radical_socialist_subtype }
	}
	SAF_walter_bayley_madeley = {
		set_nationality = PREV
		promote_character = { ideology = social_democrat_subtype }
	}
	SAF_jan_hendrik_hofmeyr = {
		set_nationality = PREV
		promote_character = { ideology = social_liberal_subtype }
	}
	SAF_gideon_brand_van_zyl = {
		set_nationality = PREV
		promote_character = { ideology = market_liberal_subtype }
	}
	if = {
		limit = { has_character = SAF_jan_christian_smuts }
		SAF_jan_christian_smuts = {
			set_nationality = PREV
			promote_character = { ideology = social_conservative_subtype }
		}
	}
	else = {
		SAF_jacobus_gideon_nel_strauss = {
			set_nationality = PREV
			promote_character = { ideology = social_conservative_subtype }
		}
	}
	if = {
		limit = { has_character = SAF_james_barry_munnik_hertzog }
		SAF_james_barry_munnik_hertzog = {
			set_nationality = PREV
			promote_character = { ideology = authoritarian_democrat_subtype }
		}
	}
	else = {
		SAF_nicolaas_christiaan_havenga = {
			set_nationality = PREV
			promote_character = { ideology = authoritarian_democrat_subtype }
		}
	}
	SAF_daniel_francois_malan = {
		set_nationality = PREV
		promote_character = { ideology = paternal_autocrat_subtype }
	}
	SAF_johannes_frederik_janse_van_rensburg = {
		set_nationality = PREV
		promote_character = { ideology = national_populist_subtype }
	}
}

SAF_federation_party_names = {
	set_country_flag = SAF_flag_labour_split_mended
	set_party_name = { ideology = social_democrat name = SAF_party_labour long_name = SAF_party_labour_long }
	set_party_name = { ideology = social_liberal name = SAF_social_liberal_party long_name = SAF_social_liberal_party_long }
	set_party_name = { ideology = market_liberal name = SAF_party_union_federal long_name = SAF_party_union_federal_long }
	set_party_name = { ideology = social_conservative name = SAF_social_conservative_party long_name = SAF_social_conservative_party_long }
	set_party_name = { ideology = authoritarian_democrat name = SAF_party_national long_name = SAF_party_national_long }
	set_party_name = { ideology = paternal_autocrat name = SAF_party_dominion long_name = SAF_party_dominion_long }
	set_party_name = { ideology = national_populist name = SAF_party_purified_national long_name = SAF_party_purified_national_generic }
}

SAF_union_party_names = {
	if = {
		limit = { has_country_flag = SAF_flag_labour_split_mended }
		set_party_name = { ideology = social_democrat name = SAF_party_labour long_name = SAF_party_labour_long }
	}
	else = {
		set_party_name = { ideology = social_democrat name = SAF_social_democrat_party long_name = SAF_social_democrat_party_long }
	}

	set_party_name = { ideology = social_liberal name = SAF_social_liberal_party long_name = SAF_social_liberal_party_long }
	set_party_name = { ideology = market_liberal name = SAF_market_liberal_party long_name = SAF_market_liberal_party_long }

	if = {
		limit = { has_country_flag = SAF_national_conservative_party_formed }
		set_party_name = { ideology = social_conservative name = SAF_party_national_conservative long_name = SAF_party_national_conservative_long }
	}
	else = {
		set_party_name = { ideology = social_conservative name = SAF_social_conservative_party long_name = SAF_social_conservative_party_long }
	}
	if = {
		limit = { has_country_flag = SAF_PNP_split }
		set_party_name = { ideology = authoritarian_democrat name = SAF_party_national long_name = SAF_party_national_long }
		set_party_name = { ideology = paternal_autocrat name = SAF_party_purified_national long_name = SAF_party_purified_national_nationalist }
		set_party_name = { ideology = national_populist name = SAF_party_purified_national long_name = SAF_party_purified_national_extremist }
	}
	else = {
		set_party_name = { ideology = authoritarian_democrat name = SAF_authoritarian_democrat_party long_name = SAF_authoritarian_democrat_party_long }
		set_party_name = { ideology = paternal_autocrat name = SAF_paternal_autocrat_party long_name = SAF_paternal_autocrat_party_long }
		set_party_name = { ideology = national_populist name = SAF_national_populist_party long_name = SAF_national_populist_party_long }
	}
}

SAF_national_party_becomes_pataut = {
	save_current_party_popularities = yes
	set_temp_variable = { SAF_new_pataut_value = saved_popularities^7 } #authdem
	add_to_temp_variable = { SAF_new_pataut_value = saved_popularities^8 } #pataut
	set_popularities = {
		totalist = saved_popularities^0
		syndicalist = saved_popularities^1
		radical_socialist = saved_popularities^2
		social_democrat = saved_popularities^3
		social_liberal = saved_popularities^4
		market_liberal = saved_popularities^5
		social_conservative = saved_popularities^6
		authoritarian_democrat = 0
		paternal_autocrat = SAF_new_pataut_value
		national_populist = saved_popularities^9
	}
}

SAF_SAP_becomes_soclib = {
	save_current_party_popularities = yes
	set_temp_variable = { SAF_new_soclib_value = saved_popularities^4 } #soclib
	add_to_temp_variable = { SAF_new_soclib_value = saved_popularities^6 } #soccon
	set_popularities = {
		totalist = saved_popularities^0
		syndicalist = saved_popularities^1
		radical_socialist = saved_popularities^2
		social_democrat = saved_popularities^3
		social_liberal = SAF_new_soclib_value
		market_liberal = saved_popularities^5
		social_conservative = 0
		authoritarian_democrat = saved_popularities^7
		paternal_autocrat = saved_popularities^8
		national_populist = saved_popularities^9
	}
}

SAF_create_george_villiers = {
	hidden_effect = {
		event_target:SAF_george_herbert_hyde_villiers_target = {
			set_nationality = PREV
			save_global_event_target_as = SAF_governor_general
		}
	}
	if = {
		limit = { has_character = SAF_george_herbert_hyde_villiers }
		SAF_george_herbert_hyde_villiers = {
			if = {
				limit = { has_ideology = social_democrat_subtype }
				promote_character = { ideology = social_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_george_herbert_hyde_villiers_leader_desc
						ideology = social_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_liberal_subtype }
				promote_character = { ideology = social_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_george_herbert_hyde_villiers_leader_desc
						ideology = social_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = market_liberal_subtype }
				promote_character = { ideology = market_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_george_herbert_hyde_villiers_leader_desc
						ideology = market_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_conservative_subtype }
				promote_character = { ideology = social_conservative_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_george_herbert_hyde_villiers_leader_desc
						ideology = social_conservative_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = authoritarian_democrat_subtype }
				promote_character = { ideology = authoritarian_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_george_herbert_hyde_villiers_leader_desc
						ideology = authoritarian_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = paternal_autocrat_subtype }
				promote_character = { ideology = paternal_autocrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_george_herbert_hyde_villiers_leader_desc
						ideology = paternal_autocrat_subtype
					}
					promote_leader = yes
				}
			}
		}
	}
}

SAF_create_patrick_duncan = {
	hidden_effect = {
		event_target:SAF_patrick_duncan_target = {
			set_nationality = PREV
			save_global_event_target_as = SAF_governor_general
		}
	}
	if = {
		limit = { has_character = SAF_patrick_duncan }
		SAF_patrick_duncan = {
			if = {
				limit = { has_ideology = social_democrat_subtype }
				promote_character = { ideology = social_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_patrick_duncan_leader_desc
						ideology = social_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_liberal_subtype }
				promote_character = { ideology = social_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_patrick_duncan_leader_desc
						ideology = social_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = market_liberal_subtype }
				promote_character = { ideology = market_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_patrick_duncan_leader_desc
						ideology = market_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_conservative_subtype }
				promote_character = { ideology = social_conservative_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_patrick_duncan_leader_desc
						ideology = social_conservative_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = authoritarian_democrat_subtype }
				promote_character = { ideology = authoritarian_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_patrick_duncan_leader_desc
						ideology = authoritarian_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = paternal_autocrat_subtype }
				promote_character = { ideology = paternal_autocrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_patrick_duncan_leader_desc
						ideology = paternal_autocrat_subtype
					}
					promote_leader = yes
				}
			}
		}
	}
}

SAF_create_nicolaas_jacobus_de_wet = {
	hidden_effect = {
		event_target:SAF_nicolaas_jacobus_de_wet_target = {
			set_nationality = PREV
			save_global_event_target_as = SAF_governor_general
		}
	}
	if = {
		limit = { has_character = SAF_nicolaas_jacobus_de_wet }
		SAF_nicolaas_jacobus_de_wet = {
			if = {
				limit = { has_ideology = social_democrat_subtype }
				promote_character = { ideology = social_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_nicolaas_jacobus_de_wet_leader_desc
						ideology = social_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_liberal_subtype }
				promote_character = { ideology = social_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_nicolaas_jacobus_de_wet_leader_desc
						ideology = social_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = market_liberal_subtype }
				promote_character = { ideology = market_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_nicolaas_jacobus_de_wet_leader_desc
						ideology = market_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_conservative_subtype }
				promote_character = { ideology = social_conservative_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_nicolaas_jacobus_de_wet_leader_desc
						ideology = social_conservative_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = authoritarian_democrat_subtype }
				promote_character = { ideology = authoritarian_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_nicolaas_jacobus_de_wet_leader_desc
						ideology = authoritarian_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = paternal_autocrat_subtype }
				promote_character = { ideology = paternal_autocrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_nicolaas_jacobus_de_wet_leader_desc
						ideology = paternal_autocrat_subtype
					}
					promote_leader = yes
				}
			}
		}
	}
}

SAF_create_ernest_jansen = {
	hidden_effect = {
		event_target:SAF_ernest_george_jansen_target = {
			set_nationality = PREV
			save_global_event_target_as = SAF_governor_general
		}
	}
	if = {
		limit = { has_character = SAF_ernest_george_jansen }
		SAF_ernest_george_jansen = {
			if = {
				limit = { has_ideology = social_democrat_subtype }
				promote_character = { ideology = social_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_ernest_george_jansen_leader_desc
						ideology = social_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_liberal_subtype }
				promote_character = { ideology = social_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_ernest_george_jansen_leader_desc
						ideology = social_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = market_liberal_subtype }
				promote_character = { ideology = market_liberal_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_ernest_george_jansen_leader_desc
						ideology = market_liberal_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = social_conservative_subtype }
				promote_character = { ideology = social_conservative_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_ernest_george_jansen_leader_desc
						ideology = social_conservative_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = authoritarian_democrat_subtype }
				promote_character = { ideology = authoritarian_democrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_ernest_george_jansen_leader_desc
						ideology = authoritarian_democrat_subtype
					}
					promote_leader = yes
				}
			}
			if = {
				limit = { has_ideology = paternal_autocrat_subtype }
				promote_character = { ideology = paternal_autocrat_subtype }
			}
			else = {
				add_country_leader_role = {
					country_leader = {
						desc = SAF_ernest_george_jansen_leader_desc
						ideology = paternal_autocrat_subtype
					}
					promote_leader = yes
				}
			}
		}
	}
}

SAF_create_governor_general = {
	hidden_effect = {
		if = {
			limit = { event_target:SAF_governor_general = { is_character = SAF_patrick_duncan } }
			SAF_create_patrick_duncan = yes
		}
		else_if = {
			limit = { event_target:SAF_governor_general = { is_character = SAF_nicolaas_jacobus_de_wet } }
			SAF_create_nicolaas_jacobus_de_wet = yes
		}
		else_if = {
			limit = { event_target:SAF_governor_general = { is_character = SAF_ernest_george_jansen } }
			SAF_create_ernest_jansen = yes
		}
		else = {
			SAF_create_george_villiers = yes
		}
	}
}

SAF_remove_governor_general = {
	hidden_effect = {
		if = {
			limit = { has_character = SAF_george_herbert_hyde_villiers }
			retire_character = SAF_george_herbert_hyde_villiers
		}
		if = {
			limit = { has_character = SAF_patrick_duncan }
			retire_character = SAF_patrick_duncan
		}
		if = {
			limit = { has_character = SAF_nicolaas_jacobus_de_wet }
			retire_character = SAF_nicolaas_jacobus_de_wet
		}
		if = {
			limit = { has_character = SAF_ernest_george_jansen }
			retire_character = SAF_ernest_george_jansen
		}
	}
}

SAF_add_entente_generals = {
	XXA = {
		every_character = {
			limit = {
				OR = {
					has_character_flag = SAF_british_character
					has_character_flag = SAF_boer_character
				}
			}
			set_nationality = PREV.PREV
		}
	}
}

SAF_remove_entente_generals = {
	every_character = {
		limit = {
			OR = {
				is_character = SAF_jan_christian_smuts
				is_character = SAF_george_edwin_brink
				is_character = SAF_isaac_pierre_de_villiers
				is_character = SAF_christiaan_ludolph_de_wet_du_toit
				is_character = SAF_guy_waterhouse_hallifax
				is_character = SAF_francis_richard_gurney_hoare
				is_character = SAF_hector_cyril_daniel
				is_character = SAF_leonard_beyers
				is_character = SAF_hesperus_andrias_van_ryneveld
				is_character = SAF_christoffel_venter
			}
		}
		set_nationality = XXA
	}
	if = {
		limit = { SAF_johannes_frederik_janse_van_rensburg = { is_unit_leader = yes } }
		SAF_johannes_frederik_janse_van_rensburg = { remove_unit_leader_role = yes }
	}
}

SAF_add_socialist_generals = {
	if = {
		limit = { SAF_james_arnold_la_guma = { is_unit_leader = no } }
		add_corps_commander_role = {
			character = SAF_james_arnold_la_guma
			traits = { politically_connected }
			skill = 1
			attack_skill = 1
			defense_skill = 1
			planning_skill = 1
			logistics_skill = 1
		}
	}
	if = {
		limit = { has_government = totalist }
		if = {
			limit = { NOT = { has_character = SAF_govan_archibald_myuyelwa_mbeki } }
			XXA = { SAF_govan_archibald_myuyelwa_mbeki = { set_nationality = PREV.PREV } }
		}
		if = {
			limit = { NOT = { has_character = SAF_thabo_edwin_mofutsanyana } }
			XXA = { SAF_thabo_edwin_mofutsanyana = { set_nationality = PREV.PREV } }
		}
	}
	else = {
		XXA = {
			every_unit_leader = {
				limit = {
					OR = {
						is_character = SAF_william_henry_andrews
						is_character = SAF_percy_john_hodgson
						is_character = SAF_adolph_gysbert_malan
						is_character = SAF_govan_archibald_myuyelwa_mbeki
						is_character = SAF_thabo_edwin_mofutsanyana
					}
				}
				set_nationality = PREV.PREV
			}
		}
	}
}

SAF_remove_socialist_generals = {
	hidden_effect = {
		if = {
			limit = { SAF_james_arnold_la_guma = { is_unit_leader = yes } }
			SAF_james_arnold_la_guma = { remove_unit_leader_role = yes }
		}
		every_unit_leader = {
			limit = {
				OR = {
					is_character = SAF_william_henry_andrews
					is_character = SAF_percy_john_hodgson
					is_character = SAF_adolph_gysbert_malan
					is_character = SAF_govan_archibald_myuyelwa_mbeki
					is_character = SAF_thabo_edwin_mofutsanyana
				}
			}
			set_nationality = XXA
		}
	}
}

SAF_teardown_black_monday_decisions = {
	remove_targeted_decision = { target = THIS decision = SAF_print_extra_money }
	remove_targeted_decision = { target = THIS decision = SAF_cut_abandonment_of_the_gold_standard }
	remove_targeted_decision = { target = THIS decision = SAF_counter_inflation }
	remove_targeted_decision = { target = THIS decision = SAF_take_a_loan }
	remove_targeted_decision = { target = THIS decision = SAF_repay_a_loan }
	remove_targeted_decision = { target = THIS decision = SAF_cut_funding_on_military }
	remove_targeted_decision = { target = THIS decision = SAF_raise_taxes }
	remove_targeted_decision = { target = THIS decision = SAF_public_work_program }
	remove_targeted_decision = { target = THIS decision = SAF_subsidize_resource_exports }
	remove_targeted_decision = { target = THIS decision = SAF_nationalize_company }
	remove_targeted_decision = { target = THIS decision = SAF_implement_tariffs }
	remove_targeted_decision = { target = THIS decision = SAF_soften_the_colour_bar }
}

SAF_teardown_nuweveld_decisions = {
	remove_targeted_decision = { target = THIS decision = SAF_campaign_against_tswana_insurgents }
	remove_targeted_decision = { target = THIS decision = SAF_increase_settler_attraction }
	remove_targeted_decision = { target = HOL decision = SAF_ask_for_permission_to_recruit_settlers }
	remove_targeted_decision = { target = FLA decision = SAF_ask_for_permission_to_recruit_settlers }
	remove_targeted_decision = { target = BEL decision = SAF_ask_for_permission_to_recruit_settlers }
	remove_targeted_decision = { target = MAF decision = SAF_ask_for_permission_to_recruit_settlers }
	remove_targeted_decision = { target = HOL decision = SAF_recruit_settlers_from_from }
	remove_targeted_decision = { target = FLA decision = SAF_recruit_settlers_from_from }
	remove_targeted_decision = { target = BEL decision = SAF_recruit_settlers_from_from }
	remove_targeted_decision = { target = MAF decision = SAF_recruit_settlers_from_from }
	remove_mission = SAF_control_the_tswana_insurgency
	remove_mission = SAF_yearly_nuweveld_report
}

SAF_setup_internal_resistance_decisions = {
	activate_targeted_decision = { target = THIS decision = SAF_suppress_ob }
	activate_targeted_decision = { target = THIS decision = SAF_suppress_icu }
	activate_targeted_decision = { target = THIS decision = SAF_construct_detention_camps }
}

SAF_teardown_internal_resistance_decisions = {
	remove_targeted_decision = { target = THIS decision = SAF_suppress_ob }
	remove_targeted_decision = { target = THIS decision = SAF_suppress_icu }
	remove_targeted_decision = { target = THIS decision = SAF_construct_detention_camps }
}

SAF_rhodesia_secedes = {
	hidden_effect = {
		545 = {
			transfer_state_to = ZIM
			remove_core_of = ROOT
			add_claim_by = ROOT
		}
		transfer_units_fraction = {
			target = ZIM
			size = 0.05
			navy_ratio = 0
			keep_unit_leaders_trigger = { always = yes }
		}
		if = {
			limit = { has_character = ZIM_godfrey_martin_huggins }
			ZIM_godfrey_martin_huggins = { set_nationality = ZIM }
			ZIM = { promote_character = ZIM_godfrey_martin_huggins }
		}
		ZIM = {
			transfer_technology = yes
			load_oob = ZIM
			meta_effect = {
				text = {
					set_politics = {
						ruling_party = social_liberal
						last_election = "[CURRENT_DATE]"
						election_frequency = 60
						elections_allowed = no
					}
				}
				CURRENT_DATE = "[?global.date.GetDateStringNoHour]"
			}
			set_temp_variable = { coalition_partner_var = token:social_democrat }
			add_to_coalition = yes
			set_temp_variable = { coalition_partner_var = token:market_liberal }
			add_to_coalition = yes
			promote_character = {
				character = ZIM_herbert_james_stanley
				ideology = social_democrat_subtype
			}
			promote_character = {
				character = ZIM_herbert_james_stanley
				ideology = social_liberal_subtype
			}
			promote_character = {
				character = ZIM_herbert_james_stanley
				ideology = market_liberal_subtype
			}
			promote_character = {
				character = ZIM_herbert_james_stanley
				ideology = social_conservative_subtype
			}
			country_event = { id = zim.1 days = 2 } #Southern Rhodesia Introduction event
			country_event = { id = zim.2 days = 15 }
		}
	}
	ZIM = {
		effect_tooltip = { transfer_state = 545 }
		declare_war_on = {
			target = ROOT
			type = annex_everything
		}
	}
}

SAF_natal_secedes = {
	set_global_flag = SAF_third_boer_war_happened
	SAF_remove_governor_general = yes
	set_victory_points = { province = 13800 value = 12 } #Pietermaritzburg

	if = {
		limit = { has_character = SAF_jan_christian_smuts }
		retire_character = SAF_jan_christian_smuts
	}

	start_civil_war = {
		### basics ###
		ideology = market_liberal
		size = 0.3
		navy_ratio = 0

		### states ###
		capital = 719
		states = { 719 }

		### unit leaders ###
		keep_unit_leaders_trigger = {
			NOT = { has_character_flag = SAF_british_character }
		}

		### country leader ###
		keep_political_leader = yes
		keep_political_party_members = yes

		### effects ###
		set_country_flag = SAF_is_natal
		set_cosmetic_tag = SAF_natal
		set_temp_variable = { coalition_partner_var = token:social_democrat }
		add_to_coalition = yes
		set_temp_variable = { coalition_partner_var = token:social_conservative }
		add_to_coalition = yes
		set_temp_variable = { coalition_partner_var = token:paternal_autocrat }
		add_to_coalition = yes
		SAF_federation_party_names = yes
		SAF_create_governor_general = yes

		load_focus_tree = {
			tree = SAF_federation_focus
			keep_completed = yes
		}
		set_popularities = {
			totalist = 0
			radical_socialist = 0
			syndicalist = 0
			social_democrat = 10
			social_liberal = 0
			market_liberal = 42
			social_conservative = 10
			authoritarian_democrat = 2
			paternal_autocrat = 36
			national_populist = 0
		}

		load_oob = SAF_naval_templates

		division_template = {
			name = "Loyalist Militia"
			is_locked = yes
			division_names_group = SAF_MIL_01
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
				infantry = { x = 0 y = 3 }
				infantry = { x = 0 y = 4 }
			}
			template_counter = 68
		}
		division_template = {
			name = "Rifle Division"
			division_names_group = SAF_CAV_01
			regiments = {
				cavalry = { x = 0 y = 0 }
				cavalry = { x = 0 y = 1 }
				cavalry = { x = 0 y = 2 }
				cavalry = { x = 1 y = 0 }
				cavalry = { x = 1 y = 1 }
				cavalry = { x = 1 y = 2 }
			}
			support = {
				recon = { x = 0 y = 0 }
			}
		}
		random_owned_controlled_state = {
			prioritize = { 719 }
			limit = { is_in_home_area = yes }
			create_unit = {
				division = "name = \"Newcastle Militia\" division_template = \"Loyalist Militia\" start_experience_factor = 0.1"
				prioritize_location = 1494
				owner = PREV
			}
			create_unit = {
				division = "name = \"Natal Mounted Rifles\" division_template = \"Rifle Division\" start_experience_factor = 0.1"
				prioritize_location = 1468
				owner = PREV
			}
		}

		add_state_claim = 542 #Bechuanaland

		country_event = { id = natal.1 days = 2 } #Natal Introduction event
		country_event = { id = natal.4 days = 4 }
	}

	country_event = { id = natal.11 days = 3 } #Navy defects to Natal
	every_character = {
		limit = { has_character_flag = SAF_british_character }
		set_nationality = NAT
	}
	NAT = {
		every_character = {
			limit = {
				is_unit_leader = no
				has_any_advisor_role = yes
			}
			meta_effect = {
				text = { set_character_name = [CHARACTER_NAME] }
				CHARACTER_NAME = "\"[?THIS.GetTokenLocalizedKey]\""
			}
		}
		activate_advisor = SAF_south_african_parliament_sic
	}
}

SAF_natal_secedes_play_as_natal = {
	set_global_flag = SAF_third_boer_war_happened
	set_victory_points = { province = 13800 value = 12 } #Pietermaritzburg
	set_capital = { state = 719 }
	set_country_flag = SAF_is_natal
	set_cosmetic_tag = SAF_natal

	save_current_party_popularities = yes
	set_temp_variable = { SAF_ideology = SAF.current_party_ideology_group }

	if = {
		limit = { has_character = SAF_jan_christian_smuts }
		retire_character = SAF_jan_christian_smuts
	}

	start_civil_war = {
		### basics ###
		ruling_party = market_liberal
		ideology = var:SAF_ideology
		size = 0.7
		navy_ratio = 1

		### states ###
		capital = 275
		states = all
		states_filter = { NOT = { state = 719 } } #Natal

		### unit leaders ###
		keep_unit_leaders_trigger = {
			NOT = { has_character_flag = SAF_boer_character }
		}

		### effects ###
		set_cosmetic_tag = SAF_republic
		SAF_remove_governor_general = yes
		load_focus_tree = {
			tree = SAF_focus
			keep_completed = yes
		}
		set_popularities = {
			totalist = saved_popularities^0
			radical_socialist = saved_popularities^1
			syndicalist = saved_popularities^2
			social_democrat = saved_popularities^3
			social_liberal = saved_popularities^4
			market_liberal = saved_popularities^5
			social_conservative = saved_popularities^6
			authoritarian_democrat = saved_popularities^7
			paternal_autocrat = saved_popularities^8
			national_populist = saved_popularities^9
		}

		load_oob = SAF_naval_templates
		save_event_target_as = SAF_boers

		add_state_claim = 542 #Bechuanaland
		add_state_claim = 545 #Rhodesia

		country_event = { id = natal.11 days = 3 } #Navy defects to Natal
	}
	SAF_federation_party_names = yes
	SAF_create_governor_general = yes
	set_temp_variable = { coalition_partner_var = token:social_democrat }
	add_to_coalition = yes
	set_temp_variable = { coalition_partner_var = token:social_conservative }
	add_to_coalition = yes
	set_temp_variable = { coalition_partner_var = token:paternal_autocrat }
	add_to_coalition = yes
	load_focus_tree = {
		tree = SAF_federation_focus
		keep_completed = yes
	}
	set_popularities = {
		totalist = 0
		radical_socialist = 0
		syndicalist = 0
		social_democrat = 10
		social_liberal = 0
		market_liberal = 42
		social_conservative = 10
		authoritarian_democrat = 2
		paternal_autocrat = 36
		national_populist = 0
	}
	add_advisor_role = {
		character = SAF_francis_richard_gurney_hoare
		advisor = {
			slot = theorist
			idea_token = SAF_francis_richard_gurney_hoare_theorist
			allowed = { original_tag = SAF }
			ledger = air
			available = {
				not_already_hired_except_as = theorist
			}
			traits = { KR_air_warfare_theorist }
			cost = 100
		}
	}
	every_character = {
		limit = { has_character_flag = SAF_boer_character }
		set_nationality = event_target:SAF_boers
	}
	event_target:SAF_boers = {
		every_character = {
			limit = {
				is_unit_leader = no
				has_any_advisor_role = yes
			}
			meta_effect = {
				text = { set_character_name = [CHARACTER_NAME] }
				CHARACTER_NAME = "\"[?THIS.GetTokenLocalizedKey]\""
			}
		}
		set_character_name = {
			character = SAF_union_defence_council
			name = SAF_union_defence_council
		}
		add_corps_commander_role = {
			character = SAF_johannes_frederik_janse_van_rensburg
			traits = { politically_connected }
			skill = 1
			attack_skill = 1
			defense_skill = 1
			planning_skill = 1
			logistics_skill = 1
		}
		activate_advisor = SAF_south_african_parliament_sic
	}
	division_template = {
		name = "Loyalist Militia"
		is_locked = yes
		division_names_group = SAF_MIL_01
		regiments = {
			infantry = { x = 0 y = 0 }
			infantry = { x = 0 y = 1 }
			infantry = { x = 0 y = 2 }
			infantry = { x = 0 y = 3 }
			infantry = { x = 0 y = 4 }
		}
		template_counter = 68
	}
	division_template = {
		name = "Rifle Division"
		division_names_group = SAF_CAV_01
		regiments = {
			cavalry = { x = 0 y = 0 }
			cavalry = { x = 0 y = 1 }
			cavalry = { x = 0 y = 2 }
			cavalry = { x = 1 y = 0 }
			cavalry = { x = 1 y = 1 }
			cavalry = { x = 1 y = 2 }
		}
		support = {
			recon = { x = 0 y = 0 }
		}
	}
	random_owned_controlled_state = {
		prioritize = { 719 }
		limit = { is_in_home_area = yes }
		create_unit = {
			division = "name = \"Newcastle Militia\" division_template = \"Loyalist Militia\" start_experience_factor = 0.1"
			prioritize_location = 1494
			owner = PREV
		}
		create_unit = {
			division = "name = \"Natal Mounted Rifles\" division_template = \"Rifle Division\" start_experience_factor = 0.1"
			prioritize_location = 1468
			owner = PREV
		}
	}
	country_event = { id = natal.1 days = 2 } #Natal Introduction event
	country_event = { id = natal.4 days = 4 }
}

SAF_spawn_natalian_militias = {
	set_province_controller = 1833
	set_province_controller = 4696
	set_province_controller = 7576
	set_province_controller = 13764
	set_province_controller = 13765
	if = {
		limit = { 681 = { is_owned_by = ROOT } }
		681 = {
			create_unit = {
				division = "name = \"Cape Town Militia\" division_template = \"Loyalist Militia\" start_experience_factor = 0.2"
				allow_spawning_on_enemy_provs = yes
				prioritize_location = 1358
				owner = PREV
			}
		}
	}
	if = {
		limit = { 946 = { is_owned_by = ROOT } }
		946 = {
			create_unit = {
				division = "name = \"Port Elizabeth Militia\" division_template = \"Loyalist Militia\" start_experience_factor = 0.3"
				allow_spawning_on_enemy_provs = yes
				prioritize_location = 13763
				owner = PREV
			}
			create_unit = {
				division = "name = \"Port Elizabeth Port Guard\" division_template = \"Loyalist Militia\" start_experience_factor = 0.1"
				allow_spawning_on_enemy_provs = yes
				prioritize_location = 13763
				owner = PREV
			}
		}
	}
	if = {
		limit = { 275 = { is_owned_by = ROOT } }
		275 = {
			create_unit = {
				division = "name = \"Johannesburg Militia\" division_template = \"Loyalist Militia\" start_experience_factor = 0.2"
				allow_spawning_on_enemy_provs = yes
				prioritize_location = 13799
				owner = PREV
			}
			create_unit = {
				division = "name = \"Fakkelkommando\" division_template = \"Loyalist Militia\" start_experience_factor = 0.5"
				allow_spawning_on_enemy_provs = yes
				prioritize_location = 13799
				owner = PREV
			}
		}
	}
}

SAF_end_civil_war = {
	### this is an extremely unelegant solution, but there's no way around it - white_peace makes either side annex the other
	if = {
		limit = { has_wargoal_against = NAT }
		remove_wargoal = { target = NAT type = all }
	}
	every_owned_state = {
		limit = { NOT = { is_fully_controlled_by = ZAR } }
		set_state_province_controller = {
			controller = ZAR
			limit = { tag = NAT }
		}
	}
	NAT = {
		if = {
			limit = { has_wargoal_against = ZAR }
			remove_wargoal = { target = ZAR type = all }
		}
		every_owned_state = {
			limit = { NOT = { is_fully_controlled_by = NAT } }
			set_state_province_controller = {
				controller = NAT
				limit = { tag = ZAR }
			}
		}
		get_current_government_type = yes
		random_other_country = {
			limit = {
				has_government = PREV
				is_in_faction = no
				NOT = { has_war_with = NAT }
			}
			set_autonomy = {
				target = NAT
				autonomy_state = kr_occupied_puppet
			}
			set_autonomy = {
				target = NAT
				autonomy_state = autonomy_free
			}
		}
		set_country_flag = SAF_is_natal #just in case
		restore_previous_government_type = yes
		if = {
			limit = { NOT = { is_in_faction_with = ENT } }
			leave_faction = yes
			set_global_flag = TEMPORARY_DISABLED_FACTION_POPUP
			ENT = { add_to_faction = PREV }
		}
		every_owned_state = {
			remove_core_of = ZAR
			remove_claim_by = ZAR
		}
	}
	every_owned_state = {
		remove_claim_by = NAT
		remove_core_of = NAT
	}
}

SAF_load_natal_content = {
	effect_tooltip = { load_focus_tree = natal_focus }
	add_ideas = NAT_idea_syndicalism_zulu
	add_ideas = NAT_idea_indian_diaspora
	add_ideas = NAT_his_majestys_most_loyal_servants_1
	if = {
		limit = { has_idea = SAF_black_monday_0 }
		remove_ideas = SAF_black_monday_0
	}
	else_if = {
		limit = { has_idea = SAF_black_monday_1 }
		remove_ideas = SAF_black_monday_1
	}
	else_if = {
		limit = { has_idea = SAF_black_monday_2 }
		remove_ideas = SAF_black_monday_2
	}
	if = {
		limit = { has_idea = SAF_idea_slavery }
		remove_ideas = SAF_idea_slavery
	}
	if = {
		limit = { has_idea = SAF_african_gold_idea }
		remove_ideas = SAF_african_gold_idea
	}
	if = {
		limit = { has_idea = SAF_idea_native_trust_and_land_act }
		remove_ideas = SAF_idea_native_trust_and_land_act
	}
	if = {
		limit = { has_idea = SAF_idea_asiatic_land_tenure_act }
		remove_ideas = SAF_idea_asiatic_land_tenure_act
	}
	if = {
		limit = { has_idea = SAF_idea_krugerpark }
		remove_ideas = SAF_idea_krugerpark
	}
	if = {
		limit = { has_idea = SAF_idea_agrarian_focus }
		remove_ideas = SAF_idea_agrarian_focus
	}
	else_if = {
		limit = { has_idea = SAF_idea_agrarian_focus_2 }
		remove_ideas = SAF_idea_agrarian_focus_2
	}
	else_if = {
		limit = { has_idea = SAF_idea_agrarian_focus_3 }
		remove_ideas = SAF_idea_agrarian_focus_3
	}
	else_if = {
		limit = { has_idea = SAF_idea_agrarian_focus_4 }
		remove_ideas = SAF_idea_agrarian_focus_4
	}
	else_if = {
		limit = { has_idea = SAF_idea_granary_of_africa }
		remove_ideas = SAF_idea_granary_of_africa
	}
	if = {
		limit = { has_idea = SAF_industrial_farming }
		remove_ideas = SAF_industrial_farming
	}
	if = {
		limit = { has_idea = SAF_idea_industrial_focus }
		remove_ideas = SAF_idea_industrial_focus
	}
	else_if = {
		limit = { has_idea = SAF_idea_industrial_focus_1 }
		remove_ideas = SAF_idea_industrial_focus_1
	}
	else_if = {
		limit = { has_idea = SAF_idea_great_repairshop }
		remove_ideas = SAF_idea_great_repairshop
	}
	else_if = {
		limit = { has_idea = SAF_idea_economic_boom }
		remove_ideas = SAF_idea_economic_boom
	}
	if = {
		limit = { has_idea = SAF_idea_kariba_dam }
		remove_ideas = SAF_idea_kariba_dam
	}
	if = {
		limit = { has_idea = SAF_sabc_idea }
		remove_ideas = SAF_sabc_idea
	}
	if = {
		limit = { has_idea = SAF_idea_sa_mathematical_society }
		remove_ideas = SAF_idea_sa_mathematical_society
	}
	if = {
		limit = { has_idea = SAF_expanded_cape_corps }
		remove_ideas = SAF_expanded_cape_corps
	}
	if = {
		limit = { has_idea = SAF_troop_specialisation_idea }
		remove_ideas = SAF_troop_specialisation_idea
	}
	else_if = {
		limit = { has_idea = SAF_special_boat_service_idea }
		remove_ideas = SAF_special_boat_service_idea
	}
	if = {
		limit = { has_idea = SAF_improved_retrofitting }
		remove_ideas = SAF_improved_retrofitting
	}
	if = {
		limit = { has_idea = SAF_trade_protection_idea }
		remove_ideas = SAF_trade_protection_idea
	}
	else_if = {
		limit = { has_idea = SAF_trade_protection_idea_2 }
		remove_ideas = SAF_trade_protection_idea_2
	}
	if = {
		limit = { has_idea = SAF_domestic_aircraft_production }
		remove_ideas = SAF_domestic_aircraft_production
	}
	if = {
		limit = { has_idea = SAF_integrated_air_recon_idea }
		remove_ideas = SAF_integrated_air_recon_idea
	}
	if = {
		limit = { has_idea = SAF_mechanised_focus_1 }
		remove_ideas = SAF_mechanised_focus_1
	}
	else_if = {
		limit = { has_idea = SAF_mechanised_focus_2 }
		remove_ideas = SAF_mechanised_focus_2
	}
	else_if = {
		limit = { has_idea = SAF_mechanised_focus_3 }
		remove_ideas = SAF_mechanised_focus_3
	}
	if = {
		limit = { has_idea = SAF_heavy_armour_focus_1 }
		remove_ideas = SAF_heavy_armour_focus_1
	}
	else_if = {
		limit = { has_idea = SAF_heavy_armour_focus_2 }
		remove_ideas = SAF_heavy_armour_focus_2
	}
	else_if = {
		limit = { has_idea = SAF_heavy_armour_focus_3 }
		remove_ideas = SAF_heavy_armour_focus_3
	}
	if = {
		limit = { has_idea = SAF_rapid_warfare_idea }
		remove_ideas = SAF_rapid_warfare_idea
	}
}

SAF_nzula_sic = {
	if = {
		limit = { NOT = { has_idea = SAF_albert_thomas_nzula_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_albert_thomas_nzula_sic
	}
}

SAF_sachs_sic = {
	if = {
		limit = { NOT = { has_idea = SAF_emil_solomon_sachs_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_emil_solomon_sachs_sic
	}
}

SAF_kotane_sic = {
	if = {
		limit = { NOT = { has_idea = SAF_moses_mauane_kotane_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_moses_mauane_kotane_sic
	}
}

SAF_gomas_sic = {
	if = {
		limit = { NOT = { has_idea = SAF_john_stephen_gomas_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_john_stephen_gomas_sic
	}
}

SAF_madeley_sic = {
	if = {
		limit = { NOT = { has_idea = SAF_walter_bayley_madeley_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_walter_bayley_madeley_sic
	}
}

SAF_smuts_sic = {
	if = {
		limit = { SAF_has_governor_general = no }
		SAF_parliament_sic = yes
	}
	else_if = {
		limit = { has_character = SAF_jan_christian_smuts }
		if = {
			limit = { NOT = { has_idea = SAF_jan_christian_smuts_sic } }
			clear_sic_slot = yes
			activate_advisor = SAF_jan_christian_smuts_sic
		}
	}
	else_if = {
		limit = { NOT = { has_idea = SAF_jacobus_gideon_nel_strauss_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_jacobus_gideon_nel_strauss_sic
	}
	if = {
		limit = { NOT = { has_country_flag = SAF_fusion } }
		set_temp_variable = { coalition_partner_var = token:social_liberal }
		add_to_coalition = yes
	}
	if = {
		limit = { NOT = { has_country_flag = saf_liberal_split } }
		set_temp_variable = { coalition_partner_var = token:market_liberal }
		add_to_coalition = yes
	}
	if = {
		limit = { has_country_flag = SAF_fusion } #another if instead of else to have the correct tooltip order
		set_temp_variable = { coalition_partner_var = token:authoritarian_democrat }
		add_to_coalition = yes
	}
}

SAF_strauss_sic = {
	if = {
		limit = { SAF_has_governor_general = no }
		SAF_parliament_sic = yes
	}
	else_if = {
		limit = { NOT = { has_idea = SAF_jacobus_gideon_nel_strauss_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_jacobus_gideon_nel_strauss_sic
	}
}

SAF_hertzog_sic = {
	if = {
		limit = { SAF_has_governor_general = no }
		SAF_parliament_sic = yes
	}
	else_if = {
		limit = { has_character = SAF_james_barry_munnik_hertzog }
		if = {
			limit = { NOT = { has_idea = SAF_james_barry_munnik_hertzog_sic } }
			clear_sic_slot = yes
			activate_advisor = SAF_james_barry_munnik_hertzog_sic
		}
	}
	else_if = {
		limit = { NOT = { has_idea = SAF_nicolaas_christiaan_havenga_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_nicolaas_christiaan_havenga_sic
	}
	if = {
		limit = { NOT = { has_country_flag = SAF_PNP_split } }
		set_temp_variable = { coalition_partner_var = token:paternal_autocrat }
		add_to_coalition = yes
		set_temp_variable = { coalition_partner_var = token:national_populist }
		add_to_coalition = yes
	}
}

SAF_havenga_sic = {
	if = {
		limit = { SAF_has_governor_general = no }
		SAF_parliament_sic = yes
	}
	else_if = {
		limit = { NOT = { has_idea = SAF_nicolaas_christiaan_havenga_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_nicolaas_christiaan_havenga_sic
	}
	if = {
		limit = { NOT = { has_country_flag = SAF_PNP_split } }
		set_temp_variable = { coalition_partner_var = token:paternal_autocrat }
		add_to_coalition = yes
		set_temp_variable = { coalition_partner_var = token:national_populist }
		add_to_coalition = yes
	}
}

SAF_malan_sic = {
	if = {
		limit = { SAF_has_governor_general = no }
		SAF_parliament_sic = yes
	}
	else_if = {
		limit = { NOT = { has_idea = SAF_daniel_francois_malan_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_daniel_francois_malan_sic
	}
	set_temp_variable = { coalition_partner_var = token:national_populist }
	add_to_coalition = yes
}

SAF_parliament_sic = {
	if = {
		limit = { NOT = { has_idea = SAF_south_african_parliament_sic } }
		clear_sic_slot = yes
		activate_advisor = SAF_south_african_parliament_sic
	}
}
