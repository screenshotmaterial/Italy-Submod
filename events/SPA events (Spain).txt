###########################
# Spain Events
###########################
# By ~mw~
###########################

add_namespace = sprd
add_namespace = sprf
add_namespace = sprc

#Events affecting other countries are under 'Foreign Policy'

# Introduction event
country_event = {
	id = sprd.1
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.1 FROM = [From.GetName]" }
	title = sprd.1.t
	desc = sprd.1.d
	picture = GFX_report_event_SPA_alfonso_xiii

	is_triggered_only = yes

	option = {
		name = sprd.1.a
		add_stability = -0.30
	}
}

# Black Monday hits Spain
country_event = {
	id = sprd.2
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.2 FROM = [From.GetName]" }
	title = sprd.2.t
	desc = sprd.2.d
	picture = GFX_report_event_NOR_black_monday

	is_triggered_only = yes

	option = {
		name = sprd.2.a
		add_stability = -0.10
		add_ideas = SPA_black_monday
		hidden_effect = {
			country_event = {
				id = sprd.3
				days = 30
				random_days = 30
			}
		}
	}
}

# Social breakdown
country_event = {
	id = sprd.3
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.3 FROM = [From.GetName]" }
	title = sprd.3.t
	desc = sprd.3.d
	picture = GFX_report_event_generic_riot

	is_triggered_only = yes

	option = {
		name = sprd.3.a
		add_stability = -0.20
	}
}

### Carlist Event Chains

# Alfonso Carlos de Borbon dies
country_event = {
	id = sprd.4
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.4 FROM = [From.GetName]" }
	title = sprd.4.t
	desc = sprd.4.d
	picture = GFX_report_event_europe_funeral

	is_triggered_only = yes

	option = {
		name = sprd.4.a
		add_stability = -0.02
	}
}

# Javier gives another speech
country_event = {
	id = sprd.8
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.8 FROM = [From.GetName]" }
	title = sprd.8.t
	desc = sprd.8.d
	picture = GFX_report_event_SPA_javier

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			country_event = {
				id = sprd.9
				days = 30
				random_days = 150
			}
			country_event = {
				id = sprd.10
				days = 30
				random_days = 150
			}
			country_event = {
				id = sprd.11
				days = 30
				random_days = 150
			}
		}
	}

	option = {
		name = sprd.8.a #Time to ban his organisation
		custom_effect_tooltip = SPA_ban_carlists
		add_stability = -0.20
		set_country_flag = SPA_javier_banned
	}
	option = {
		name = sprd.8.b #Arrest Javier and his followers!
		custom_effect_tooltip = SPA_arrest_javier
		add_stability = -0.10
		set_country_flag = SPA_javier_arrested
		hidden_effect = {
			POR = {
				country_event = {
					id = sprf.3
					days = 20
					random_days = 80
				}
			}
		}
	}
	option = {
		name = sprd.8.c #Praise his efforts
		custom_effect_tooltip = SPA_encourage_javier
		add_political_power = -100
	}
	option = {
		name = sprd.8.e #Ignore the pretender
		add_political_power = -50
		add_stability = -0.05
		set_country_flag = SPA_javier_ignored
	}
}

# Carlist bombing
country_event = {
	id = sprd.9
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.9 FROM = [From.GetName]" }
	title = sprd.9.t
	desc = sprd.9.d
	picture = GFX_report_event_IRE_bombing

	is_triggered_only = yes

	trigger = {
		OR = {
			has_country_flag = SPA_javier_banned
			has_country_flag = SPA_javier_arrested
			has_country_flag = SPA_javier_ignored
		}
		NOT = {
			country_exists = SPR
			country_exists = SWF
			has_country_flag = election_success
			has_country_flag = aftermath_of_the_civil_war
		}
	}

	immediate = {
		hidden_effect = {
			country_event = {
				id = sprd.9
				days = 30
				random_days = 150
			}
		}
	}

	option = {
		name = sprd.9.a
		add_stability = -0.02
	}
}

# Carlist Demonstrations
country_event = {
	id = sprd.10
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.10 FROM = [From.GetName]" }
	title = sprd.10.t
	desc = sprd.10.d
	picture = GFX_report_event_gathering_protest

	is_triggered_only = yes

	trigger = {
		OR = {
			has_country_flag = SPA_javier_banned
			has_country_flag = SPA_javier_ignored
		}
		NOT = {
			country_exists = SPR
			country_exists = SWF
			has_country_flag = election_success
			has_country_flag = aftermath_of_the_civil_war
		}
	}

	immediate = {
		hidden_effect = {
			country_event = {
				id = sprd.10
				days = 30
				random_days = 150
			}
		}
	}

	option = {
		name = sprd.10.a
		add_stability = -0.05
	}
}

# Assassination of Miguel Ponte Manso de Zuniga
country_event = {
	id = sprd.11
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.11 FROM = [From.GetName]" }
	title = sprd.11.t
	desc = sprd.11.d
	picture = GFX_report_event_generic_funeral

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			has_country_flag = SPA_javier_banned
			has_country_flag = SPA_javier_arrested
			has_country_flag = SPA_cntfai_disband
			has_country_flag = SPA_cntfai_arrest
		}
		NOT = {
			country_exists = SPR
			country_exists = SWF
			has_country_flag = election_success
			has_country_flag = aftermath_of_the_civil_war
		}
	}

	option = {
		name = sprd.11.a
		add_stability = -0.05
	}
}

### CNT-FAI event chains

# The CNT-FAI speech
country_event = {
	id = sprd.13
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.13 FROM = [From.GetName]" }
	title = sprd.13.t
	desc = sprd.13.d
	picture = GFX_report_event_SPA_CNT_FAI

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			country_event = {
				id = sprd.14
				days = 20
				random_days = 30
			}
		}
	}

	option = {
		name = sprd.13.a #Ban the organisation of workers
		custom_effect_tooltip = SPA_ban_cntfai
		add_political_power = -100
		add_stability = -0.05
		add_popularity = {
			ideology = social_liberal
			popularity = -0.03
		}
		hidden_effect = {
			country_event = {
				id = sprd.15
				days = 20
				random_days = 30
			}
		}
	}
	option = {
		name = sprd.13.b #Arrest the leaders of the movement
		custom_effect_tooltip = SPA_arrest_cntfai
		add_stability = -0.10
		set_country_flag = SPA_cntfai_arrest
		add_popularity = {
			ideology = social_conservative
			popularity = -0.03
		}
		add_popularity = {
			ideology = social_liberal
			popularity = -0.03
		}
		add_popularity = {
			ideology = radical_socialist
			popularity = -0.03
		}
		add_popularity = {
			ideology = syndicalist
			popularity = -0.03
		}
		hidden_effect = {
			country_event = {
				id = sprd.16
				days = 20
				random_days = 30
			}
		}
	}
	option = {
		name = sprd.13.c #Forcefully disband the movement
		custom_effect_tooltip = SPA_force_cntfai
		add_stability = -0.20
		set_country_flag = SPA_cntfai_disband
		add_popularity = {
			ideology = social_conservative
			popularity = -0.05
		}
		add_popularity = {
			ideology = social_liberal
			popularity = -0.05
		}
		add_popularity = {
			ideology = radical_socialist
			popularity = -0.03
		}
		add_popularity = {
			ideology = syndicalist
			popularity = -0.03
		}
		hidden_effect = {
			country_event = {
				id = sprd.17
				days = 20
				random_days = 30
			}
		}
	}
	option = {
		name = sprd.13.e #Allow this to happen
		custom_effect_tooltip = SPA_allow_cntfai
		add_political_power = -200
		add_popularity = {
			ideology = social_conservative
			popularity = 0.03
		}
		add_popularity = {
			ideology = radical_socialist
			popularity = 0.03
		}
		add_popularity = {
			ideology = syndicalist
			popularity = 0.03
		}
		hidden_effect = {
			country_event = {
				id = sprd.18
				days = 20
				random_days = 80
			}
		}
	}
}

# CNT-FAI Protests
country_event = {
	id = sprd.14
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.14 FROM = [From.GetName]" }
	title = sprd.14.t
	desc = sprd.14.d
	picture = GFX_report_event_gathering_protest

	is_triggered_only = yes

	option = {
		name = sprd.14.a
		add_stability = -0.05
	}
}

# National CNT-FAI Protests
country_event = {
	id = sprd.15
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.15 FROM = [From.GetName]" }
	title = sprd.15.t
	desc = sprd.15.d
	picture = GFX_report_event_gathering_protest

	is_triggered_only = yes

	option = {
		name = sprd.15.a #Send out the police!
		add_stability = -0.10
	}
	option = {
		name = sprd.15.b #Allow them to organise
		custom_effect_tooltip = SPA_allow_cntfai
		add_popularity = {
			ideology = social_conservative
			popularity = 0.03
		}
		add_popularity = {
			ideology = radical_socialist
			popularity = 0.03
		}
		add_popularity = {
			ideology = syndicalist
			popularity = 0.03
		}
	}
}

# Arresting the CNT-FAI
country_event = {
	id = sprd.16
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.16 FROM = [From.GetName]" }
	title = sprd.16.t
	desc = sprd.16.d
	picture = GFX_report_event_HOL_zwolle_riots

	is_triggered_only = yes

	option = {
		name = sprd.16.a #Find the rat and establish a secret police!
		add_stability = 0.05
		hidden_effect = {
			random_other_country = {
				limit = {
					OR = {
						tag = FRA
						tag = ENG
						tag = SRI
					}
				}
				country_event = { id = sprf.5 days = 15 }
			}
		}
	}
}

# Forcefully Disbanding the CNT-FAI
country_event = {
	id = sprd.17
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.17 FROM = [From.GetName]" }
	title = sprd.17.t
	desc = sprd.17.d
	picture = GFX_report_event_HOL_zwolle_riots

	is_triggered_only = yes

	option = {
		name = sprd.17.a
		add_stability = 0.05
		hidden_effect = {
			random_other_country = {
				limit = {
					OR = {
						tag = FRA
						tag = ENG
						tag = SRI
					}
				}
				country_event = { id = sprf.5 days = 15 }
			}
		}
	}
}

# CNT-FAI organising the workers
country_event = {
	id = sprd.18
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.18 FROM = [From.GetName]" }
	title = sprd.18.t
	desc = sprd.18.d
	picture = GFX_report_event_SPA_CNT_FAI

	is_triggered_only = yes

	option = {
		name = sprd.18.a
		add_stability = 0.02
		hidden_effect = {
			country_event = {
				id = sprd.19
				days = 20
				random_days = 80
			}
		}
	}
}

# CNT-FAI Plan South commenced
country_event = {
	id = sprd.19
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.19 FROM = [From.GetName]" }
	title = sprd.19.t
	desc = sprd.19.d
	picture = GFX_report_event_generic_economic_policy

	is_triggered_only = yes

	option = {
		name = sprd.19.a
		add_stability = 0.05
		set_country_flag = SPA_cntfai_plan_south
		hidden_effect = {
			country_event = {
				id = sprd.20
				days = 20
				random_days = 80
			}
		}
	}
}

# CNT-FAI Plan South completed
country_event = {
	id = sprd.20
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.20 FROM = [From.GetName]" }
	title = sprd.20.t
	desc = sprd.20.d
	picture = GFX_report_event_generic_economic_policy

	is_triggered_only = yes

	option = {
		name = sprd.20.a
		173 = {
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
			}
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
			add_resource = {
				type = steel
				amount = 4
			}
		}
		168 = {
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = infrastructure
				level = 1
				instant_build = yes
			}
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
	}
}

### Election event chains

# King Alfonso has a stroke
country_event = {
	id = sprd.21
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.21 FROM = [From.GetName]" }
	title = sprd.21.t
	desc = sprd.21.d
	picture = GFX_report_event_SPA_alfonso_xiii

	is_triggered_only = yes

	option = {
		name = sprd.21.a
		set_country_flag = SPA_alfonso_coma
		add_political_power = -100
		add_stability = -0.10
		hidden_effect = {
			country_event = {
				id = sprd.22
				days = 10
			}
		}
	}
}

# King Alfonso is in a coma
country_event = {
	id = sprd.22
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.22 FROM = [From.GetName]" }
	title = sprd.22.t
	desc = sprd.22.d
	picture = GFX_report_event_SPA_alfonso_xiii

	is_triggered_only = yes

	option = {
		name = sprd.22.a #Call for open elections
		ai_chance = {
			base = 20
			modifier = {
				factor = 0
				has_game_rule = {
					rule = SPA_civil_war
					option = DEFAULT
				}
			}
		}
		custom_effect_tooltip = SPA_free_elections
		hidden_effect = {
			country_event = {
				id = sprd.23
				days = 5
			}
		}
	}
	option = {
		name = sprd.22.b #Call for elections, but with only selected parties
		ai_chance = {
			base = 40
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = SPA_civil_war
						option = SPA_CIVIL_WAR_AVOIDED_SPA
					}
					has_game_rule = {
						rule = SPA_civil_war
						option = SPA_CIVIL_WAR_AVOIDED_SWF
					}
					has_game_rule = {
						rule = SPA_civil_war
						option = SPA_CIVIL_WAR_AVOIDED_SPR
					}
				}
			}
		}
		custom_effect_tooltip = SPA_rig_elections
		hidden_effect = {
			country_event = {
				id = sprd.25
				days = 5
			}
		}
	}
	option = {
		name = sprd.22.c #The King is not dead! Do nothing!
		ai_chance = {
			base = 40
			modifier = {
				factor = 0
				OR = {
					has_game_rule = {
						rule = SPA_civil_war
						option = SPA_CIVIL_WAR_AVOIDED_SPA
					}
					has_game_rule = {
						rule = SPA_civil_war
						option = SPA_CIVIL_WAR_AVOIDED_SWF
					}
					has_game_rule = {
						rule = SPA_civil_war
						option = SPA_CIVIL_WAR_AVOIDED_SPR
					}
				}
			}
		}
		add_stability = -0.10
		set_country_flag = SPA_cntfai_will_rise
		set_country_flag = SPA_carlists_will_rise
	}
}

# Free elections are held
country_event = {
	id = sprd.23
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.23 FROM = [From.GetName]" }
	title = sprd.23.t
	desc = sprd.23.d
	picture = GFX_report_event_election_vote

	trigger = {
		NOT = {
			has_war_with = SPR
			has_war_with = SWF
		}
	}

	is_triggered_only = yes

	option = {
		name = sprd.23.a
		random_list = {
			40 = {
				modifier = {
					factor = 0
					OR = {
						has_game_rule = {
							rule = SPA_civil_war
							option = SPA_CIVIL_WAR_AVOIDED_SWF
						}
						has_game_rule = {
							rule = SPA_civil_war
							option = SPA_CIVIL_WAR_AVOIDED_SPR
						}
					}
				}
				modifier = {
					factor = 0
					is_ai = yes
					NOT = {
						has_game_rule = {
							rule = SPA_civil_war
							option = SPA_CIVIL_WAR_AVOIDED_SPA
						}
					}
				}
				custom_effect_tooltip = SPA_ruling_party_wins
				hidden_effect = {
					country_event = {
						id = sprd.34
						hours = 5
					}
				}
			}
			30 = {
				modifier = {
					factor = 0
					OR = {
						has_game_rule = {
							rule = SPA_civil_war
							option = SPA_CIVIL_WAR_AVOIDED_SPA
						}
						has_game_rule = {
							rule = SPA_civil_war
							option = SPA_CIVIL_WAR_AVOIDED_SPR
						}
					}
				}
				custom_effect_tooltip = SPA_SWF_wins
				hidden_effect = {
					country_event = {
						id = sprd.35
						hours = 5
					}
				}
			}
			30 = {
				modifier = {
					factor = 0
					OR = {
						has_game_rule = {
							rule = SPA_civil_war
							option = SPA_CIVIL_WAR_AVOIDED_SPA
						}
						has_game_rule = {
							rule = SPA_civil_war
							option = SPA_CIVIL_WAR_AVOIDED_SWF
						}
					}
				}
				custom_effect_tooltip = SPA_SPR_wins
				hidden_effect = {
					country_event = {
						id = sprd.36
						hours = 5
					}
				}
			}
		}
	}
}

# Election riots
country_event = {
	id = sprd.25
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.25 FROM = [From.GetName]" }
	title = sprd.25.t
	desc = sprd.25.d
	picture = GFX_report_event_gathering_protest

	is_triggered_only = yes

	option = {
		name = sprd.25.a #Call off the election - Martial Law is declared
		ai_chance = {
			base = 75
		}
		custom_effect_tooltip = SPA_cancel_election
		add_political_power = -200
		add_stability = 0.10
		set_country_flag = SPA_cntfai_will_rise
		set_country_flag = SPA_carlists_will_rise
	}
	option = {
		name = sprd.25.b #Nothing will stop this election
		ai_chance = {
			base = 25
		}
		add_stability = -0.10
		hidden_effect = {
			country_event = {
				id = sprd.26
				days = 1
			}
		}
	}
}

# Election day disaster
country_event = {
	id = sprd.26
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.26 FROM = [From.GetName]" }
	title = sprd.26.t
	desc = sprd.26.d
	picture = GFX_report_event_generic_riot

	is_triggered_only = yes

	trigger = {
		NOT = {
			has_war_with = SWF
			has_war_with = SPR
		}
	}

	option = {
		name = sprd.26.a
		add_stability = -0.10
		add_manpower = -10000
		set_country_flag = SPA_cntfai_will_rise
		set_country_flag = SPA_carlists_will_rise
	}
}

### POST-WAR EVENTS

# Replacing the king - Juan not assassinated
country_event = {
	id = sprd.27
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.27 FROM = [From.GetName]" }

	title = {
		text = sprd.27.t.juan
		trigger = { has_character = SPA_juan_de_borbon }
	}
	title = {
		text = sprd.27.t.jaime
		trigger = { NOT = { has_character = SPA_juan_de_borbon } }
	}
	desc = {
		text = sprd.27.d.juan
		trigger = { has_character = SPA_juan_de_borbon }
	}
	desc = {
		text = sprd.27.d.jaime
		trigger = { NOT = { has_character = SPA_juan_de_borbon } }
	}

	picture = GFX_report_event_SPA_alfonso_xiii

	is_triggered_only = yes

	option = {
		name = sprd.27.a #Name him as Alfonso's successor
		ai_chance = {
			base = 80
			modifier = {
				add = -20
				NOT = { has_character = SPA_juan_de_borbon }
			}
		}
		add_political_power = 40
		add_popularity = {
			ideology = authoritarian_democrat
			popularity = 0.1
		}
		retire_character = SPA_alfonso_de_borbon
		SPA_create_juan = yes
	}
	option = {
		name = sprd.27.b #No, the time of the kingdom is over
		ai_chance = {
			base = 20
			modifier = {
				add = 20
				NOT = { has_character = SPA_juan_de_borbon }
			}
		}
		add_political_power = -100
		set_cosmetic_tag = SPA_republic
		if = {
			limit = { has_idea = SPA_memories_of_the_republic }
			remove_ideas = SPA_memories_of_the_republic
		}
		retire_character = SPA_alfonso_de_borbon
		hidden_effect = { SPA_remove_monarchy = yes }
	}
}

# Spain asks to join a faction
country_event = {
	id = sprd.31
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.31 FROM = [From.GetName]" }
	title = sprd.31.t
	desc = sprd.31.d
	picture = GFX_report_event_generic_diplomacy4

	is_triggered_only = yes

	option = {
		name = sprd.31.a #Absolutely, they are welcome
		ai_chance = { base = 100 }
		FROM = { country_event = { id = sprd.32 hours = 5 } }
		effect_tooltip = { add_to_faction = FROM }
	}
	option = {
		name = sprd.31.b #It's not a good idea
		ai_chance = { base = 0 }
		FROM = { country_event = { id = sprd.33 hours = 5 } }
	}
}

# Spain admitted to faction
country_event = {
	id = sprd.32
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.32 FROM = [From.GetName]" }
	title = sprd.32.t
	desc = sprd.32.d
	picture = GFX_report_event_generic_diplomacy3

	is_triggered_only = yes

	option = {
		name = sprd.32.a
		FROM = { add_to_faction = ROOT }
	}
}

# Spain is turned down
country_event = {
	id = sprd.33
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.33 FROM = [From.GetName]" }
	title = sprd.33.t
	desc = sprd.33.d
	picture = GFX_report_event_worried_french

	is_triggered_only = yes

	option = {
		name = sprd.33.a
		add_political_power = -20
	}
}

# The ruling party wins the elections
country_event = {
	id = sprd.34
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.34 FROM = [From.GetName]" }
	title = sprd.34.t
	desc = sprd.34.d
	picture = GFX_report_event_election_vote

	is_triggered_only = yes

	option = {
		name = sprd.34.a
		add_stability = 0.10
		add_popularity = {
			ideology = social_conservative
			popularity = 0.2
		}
		set_country_flag = election_success
		clr_country_flag = SPA_carlists_will_rise
		clr_country_flag = SPA_cntfai_will_rise
		hidden_effect = {
			news_event = worldnews.85
		}
	}
}

# The CNT-FAI wins the elections
country_event = {
	id = sprd.35
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.35 FROM = [From.GetName]" }
	title = sprd.35.t
	desc = sprd.35.d
	picture = GFX_report_event_election_vote

	is_triggered_only = yes

	option = {
		name = sprd.35.a #We will abide by the result
		ai_chance = {
			base = 0
			modifier = {
				add = 1
				has_game_rule = {
					rule = SPA_civil_war
					option = SPA_CIVIL_WAR_AVOIDED_SWF
				}
			}
		}
		custom_effect_tooltip = SPA_become_SWF
		hidden_effect = {
			if = {
				limit = {
					has_idea = SPA_black_monday
				}
				set_global_flag = SPA_black_monday
			}
			if = {
				limit = {
					has_idea = SPA_social_breakdown
				}
				set_global_flag = SPA_social_breakdown
			}
			if = {
				limit = {
					has_idea = SPA_social_breakdown_2
				}
				set_global_flag = SPA_social_breakdown_2
			}
			if = {
				limit = {
					has_idea = SPA_social_breakdown_3
				}
				set_global_flag = SPA_social_breakdown_3
			}
			every_state = {
				limit = { is_core_of = SPA }
				add_core_of = SWF
			}
			every_state = {
				limit = { is_claimed_by = SPA }
				remove_claim_by = SPA
				add_claim_by = SWF
			}
			SWF = { transfer_technology_without_doctrines = yes }
			random_owned_controlled_state = {
				SWF = {
					transfer_state = PREV
				}
			}
			SWF = {
				annex_country = {
					target = SPA
					transfer_troops = yes
				}
				set_country_flag = election_success
				add_stability = 0.10
				drop_cosmetic_tag = yes
				if = {
					limit = {
						has_global_flag = SPA_black_monday
					}
					clr_global_flag = SPA_black_monday
					add_ideas = SPA_black_monday
				}
				if = {
					limit = {
						has_global_flag = SPA_social_breakdown
					}
					clr_global_flag = SPA_social_breakdown
					add_ideas = SPA_social_breakdown
				}
				if = {
					limit = {
						has_global_flag = SPA_social_breakdown_2
					}
					clr_global_flag = SPA_social_breakdown_2
					add_ideas = SPA_social_breakdown_2
				}
				if = {
					limit = {
						has_global_flag = SPA_social_breakdown_3
					}
					clr_global_flag = SPA_social_breakdown_3
					add_ideas = SPA_social_breakdown_3
				}
				change_tag_from = SPA
			}
			every_state = {
				limit = { is_core_of = SPA }
				remove_core_of = SPA
			}
			news_event = worldnews.85
		}
	}
	option = {
		name = sprd.35.b #Never! Invalidate the elections!
		ai_chance = {
			base = 70
			modifier = {
				factor = 0
				has_game_rule = {
					rule = SPA_civil_war
					option = SPA_CIVIL_WAR_AVOIDED_SWF
				}
			}
		}
		add_political_power = -200
		add_stability = -0.10
		set_country_flag = SPA_cntfai_will_rise
	}
}

# The Carlists win the elections
country_event = {
	id = sprd.36
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprd.36 FROM = [From.GetName]" }
	title = sprd.36.t
	desc = sprd.36.d
	picture = GFX_report_event_election_vote

	is_triggered_only = yes

	option = {
		name = sprd.35.a #We will abide by the result
		ai_chance = {
			base = 0
			modifier = {
				add = 1
				has_game_rule = {
					rule = SPA_civil_war
					option = SPA_CIVIL_WAR_AVOIDED_SPR
				}
			}
		}
		custom_effect_tooltip = SPA_become_SPR
		hidden_effect = {
			if = {
				limit = {
					has_idea = SPA_black_monday
				}
				set_global_flag = SPR_black_monday
			}
			if = {
				limit = {
					has_idea = SPA_social_breakdown
				}
				set_global_flag = SPA_social_breakdown
			}
			if = {
				limit = {
					has_idea = SPA_social_breakdown_2
				}
				set_global_flag = SPA_social_breakdown_2
			}
			if = {
				limit = {
					has_idea = SPA_social_breakdown_3
				}
				set_global_flag = SPA_social_breakdown_3
			}
			every_state = {
				limit = {
					is_core_of = SPA
				}
				add_core_of = SPR
			}
			every_state = {
				limit = {
					is_claimed_by = SPA
				}
				remove_claim_by = SPA
				add_claim_by = SPR
			}
			SPR = { transfer_technology_without_doctrines = yes }
			random_owned_controlled_state = {
				SPR = {
					transfer_state = PREV
				}
			}
			SPR = {
				annex_country = {
					target = SPA
					transfer_troops = yes
				}
				set_country_flag = election_success
				add_stability = 0.10
				if = {
					limit = {
						has_global_flag = SPR_black_monday
					}
					clr_global_flag = SPR_black_monday
					add_ideas = SPR_black_monday
				}
				if = {
					limit = {
						has_global_flag = SPA_social_breakdown
					}
					clr_global_flag = SPA_social_breakdown
					add_ideas = SPA_social_breakdown
				}
				if = {
					limit = {
						has_global_flag = SPA_social_breakdown_2
					}
					clr_global_flag = SPA_social_breakdown_2
					add_ideas = SPA_social_breakdown_2
				}
				if = {
					limit = {
						has_global_flag = SPA_social_breakdown_3
					}
					clr_global_flag = SPA_social_breakdown_3
					add_ideas = SPA_social_breakdown_3
				}
				change_tag_from = SPA
			}
			every_state = {
				limit = { is_core_of = SPA }
				remove_core_of = SPA
			}
			news_event = worldnews.85
		}
	}
	option = {
		name = sprd.35.b #Never! Invalidate the elections!
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				has_game_rule = {
					rule = SPA_civil_war
					option = SPA_CIVIL_WAR_AVOIDED_SPR
				}
			}
		}
		add_political_power = -200
		add_stability = -0.10
		set_country_flag = SPA_carlists_will_rise
	}
}

########################################
#### Kingdom of Spain, Foreign Policy
########################################

# Carlists flee to Portugal
country_event = {
	id = sprf.3
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprf.3 FROM = [From.GetName]" }
	title = sprf.3.t
	desc = sprf.3.d
	picture = GFX_report_event_SPA_javier

	is_triggered_only = yes

	option = {
		name = sprf.3.a #Allow them to continue operating from Portugal
		ai_chance = {
			base = 85
		}
		add_political_power = 50
		reverse_add_opinion_modifier = {
			target = GER
			modifier = KR_hates_govt
		}
		reverse_add_opinion_modifier = {
			target = AUS
			modifier = KR_hates_govt
		}
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = KR_outraged
		}
	}
	option = {
		name = sprf.3.b #Break off diplomatic relations with Spain
		ai_chance = {
			base = 10
		}
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = KR_outraged
		}
	}
	option = {
		name = sprf.3.c #Wash our hands of the Carlists
		ai_chance = {
			base = 5
		}
		add_political_power = -100
	}
}

# CNT-FAI flees to FRA/SRI/ENG
country_event = {
	id = sprf.5
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprf.5 FROM = [From.GetName]" }
	title = sprf.4.t
	desc = sprf.4.d
	picture = GFX_report_event_SPA_SWF_refugees

	is_triggered_only = yes

	trigger = {
		has_socialist_government = yes
		NOT = {
			country_exists = SWF
			has_global_flag = spanish_civil_war
		}
	}

	option = {
		name = sprf.4.a
		ai_chance = {
			base = 75
			modifier = {
				add = -40
				tag = FRA
				NOT = { has_country_flag = FRA_support_SWF }
			}
			modifier = {
				add = 10
				tag = FRA
				has_country_flag = FRA_support_SWF
			}
			modifier = {
				add = -70
				tag = ENG
				NOT = { has_country_flag = FRA_support_SWF }
			}
		}
		set_variable = { SWF.SWF_foreign_support = ROOT }
		add_political_power = 60
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = cntfai_supported
		}
		add_manpower = -20000
		add_equipment_to_stockpile = {
			type = infantry_equipment
			amount = -500
		}
	}
	option = {
		name = sprf.4.b
		ai_chance = {
			base = 20
			modifier = {
				add = 25
				tag = FRA
				NOT = { has_country_flag = FRA_support_SWF }
			}
			modifier = {
				add = -10
				tag = FRA
				has_country_flag = FRA_support_SWF
			}
		}
		add_political_power = -20
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = cntfai_given_refuge
		}
	}
	option = {
		name = sprf.4.c
		ai_chance = {
			base = 5
			modifier = {
				add = 15
				tag = FRA
				NOT = { has_country_flag = FRA_support_SWF }
			}
			modifier = {
				add = 70
				tag = ENG
				NOT = { has_country_flag = FRA_support_SWF }
			}
		}
		add_political_power = -100
		set_country_flag = SWF_kicked_out
		reverse_add_opinion_modifier = {
			target = SPA
			modifier = cntfai_kicked_out
		}
		hidden_effect = {
			random_other_country = {
				limit = {
					OR = {
						tag = FRA
						tag = ENG
						tag = SRI
					}
					NOT = { has_country_flag = SWF_kicked_out }
				}
				country_event = { id = sprf.5 days = 15 }
			}
		}
	}
}

########################################
#### Spanish Civil War
########################################

### UPRISINGS ###

# Carlist Uprising begins
country_event = {
	id = sprc.1
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.1 FROM = [From.GetName]" }
	title = sprc.1.t
	desc = sprc.1.d
	picture = GFX_report_event_SPA_civwar

	fire_only_once = yes

	trigger = {
		tag = SPA
		has_country_flag = SPA_carlists_will_rise
		OR = {
			176 = { is_owned_and_controlled_by = SPA } #Castilla la Vieja
			172 = { is_owned_and_controlled_by = SPA } #Navarra
			174 = { is_owned_and_controlled_by = SPA } #León
			171 = { is_owned_and_controlled_by = SPA } #Galicia
			793 = { is_owned_and_controlled_by = SPA } #Asturias
			1070 = { is_owned_and_controlled_by = SPA } #Basque Country
			1081 = { is_owned_and_controlled_by = SPA } #Valladolid
		}
		NOT = { has_country_flag = election_success }
	}

	mean_time_to_happen = {
		days = 7
	}

	immediate = {
		set_country_flag = SPA_cntfai_will_rise
		hidden_effect = {
			SPR = {
				load_oob = SPR_naval
				transfer_technology_without_doctrines = yes
			}
			every_state = {
				limit = {
					OR = {
						is_core_of = SPA
						is_claimed_by = SPA
						is_core_of = SWF
					}
				}
				add_claim_by = SPR
			}
			every_owned_state = {
				limit = {
					is_controlled_by = ROOT
					OR = {
						state = 176 #Castilla la Vieja
						state = 172 #Navarra
						state = 174 #León
						state = 171 #Galicia
						state = 793 #Asturias
						state = 1070 #Basque Country
						state = 1081 #Valladolid
					}
				}
				remove_claim_by = SPR
				add_core_of = SPR
				SPR = {
					transfer_state = PREV
				}
				teleport_armies = {
					to_state_array = core_states
				}
				remove_core_of = SPA
				add_claim_by = SPA
			}
			if = {
				limit = { has_idea = SPA_black_monday }
				SPR = { add_ideas = SPR_black_monday }
			}
			if = {
				limit = { has_idea = SPA_social_breakdown }
				SPR = { add_ideas = SPA_social_breakdown }
			}
			if = {
				limit = { has_idea = SPA_social_breakdown_2 }
				SPR = { add_ideas = SPA_social_breakdown_2 }
			}
			if = {
				limit = { has_idea = SPA_social_breakdown_3 }
				SPR = { add_ideas = SPA_social_breakdown_3 }
			}
		}
	}

	option = {
		name = sprc.1.a #We shall fight them!
		if = {
			limit = { is_ai = yes }
			hidden_effect = {
				if = {
					limit = {
						NOT = { has_template = "Guardias de Reserva" }
					}
					division_template = {
						name = "Guardias de Reserva"
						division_names_group = SPA_INF_01
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 0 y = 2 }
							infantry = { x = 1 y = 0 }
							infantry = { x = 1 y = 1 }
							infantry = { x = 1 y = 2 }
							infantry = { x = 2 y = 0 }
							infantry = { x = 2 y = 1 }
							infantry = { x = 2 y = 2 }
						}
						support = {
							artillery = { x = 0 y = 0 }
						}
					}
				}
				41 = {
					create_unit = {
						division = "name = \"Falange de Madrid\" division_template = \"Guardias de Reserva\" start_experience_factor = 0 start_equipment_factor = 1.0"
						owner = SPA
						prioritize_location = 3938
					}
				}
			}
		}
		SPR = {
			country_event = {
				id = sprc.2
				days = 7
			}
		}
	}
	option = {
		name = sprc.1.b #Long live Javier I! (Play as the Carlists)
		ai_chance = { base = 0 }
		hidden_effect = {
			if = {
				limit = {
					NOT = { has_template = "Guardias de Reserva" }
				}
				division_template = {
					name = "Guardias de Reserva"
					division_names_group = SPA_INF_01
					regiments = {
						infantry = { x = 0 y = 0 }
						infantry = { x = 0 y = 1 }
						infantry = { x = 0 y = 2 }
						infantry = { x = 1 y = 0 }
						infantry = { x = 1 y = 1 }
						infantry = { x = 1 y = 2 }
						infantry = { x = 2 y = 0 }
						infantry = { x = 2 y = 1 }
						infantry = { x = 2 y = 2 }
					}
					support = {
						artillery = { x = 0 y = 0 }
					}
				}
			}
			41 = {
				create_unit = {
					division = "name = \"Falange de Madrid\" division_template = \"Guardias de Reserva\" start_experience_factor = 0 start_equipment_factor = 1.0"
					owner = SPA
					prioritize_location = 3938
				}
			}
		}
		SPR = {
			country_event = {
				id = sprc.2
				days = 7
			}
			change_tag_from = SPA
		}
	}
}

# Carlist boot event
country_event = {
	id = sprc.2
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.2 FROM = [From.GetName]" }
	title = sprc.2.t
	desc = sprc.2.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	option = {
		name = sprc.2.a
		hidden_effect = {
			load_oob = "SCW_SPR"
		}
		if = {
			limit = {
				is_ai = yes
			}
			hidden_effect = {
				load_oob = SCW_SPR_reinforce1
			}
		}
		set_global_flag = spanish_civil_war
		add_equipment_to_stockpile = {
			type = infantry_equipment_1
			amount = 2000
			producer = ITA
		}
		add_opinion_modifier = {
			target = ITA
			modifier = supports_us_civil_war_2
		}
		add_opinion_modifier = {
			target = AUS
			modifier = supports_us_civil_war_1
		}
		add_opinion_modifier = {
			target = POR
			modifier = supports_us_civil_war_1
		}
		add_opinion_modifier = {
			target = GER
			modifier = against_us_civil_war_1
		}
		reverse_add_opinion_modifier = {
			target = GER
			modifier = against_carlist_1
		}
		if = {
			limit = {
				owns_state = 176
			}
			set_capital = { state = 176 }
		}
		declare_war_on = {
			target = SPA
			type = civil_war
		}
		add_civil_war_target = SPA
		if = {
			limit = { can_declare_war_on = SWF }
			declare_war_on = {
				target = SWF
				type = civil_war
			}
			add_civil_war_target = SWF
			SPA = {
				add_named_threat = {
					threat = 5
					name = SPA_civil_war_threat
				}
			}
			hidden_effect = {
				news_event = { id = sprc.400 days = 1 }
			}
		}
		add_ideas = extensive_conscription
		add_ideas = SPR_rally_carlists_idea
	}
}

# CNT-FAI uprising begins
country_event = {
	id = sprc.3
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.3 FROM = [From.GetName]" }
	title = sprc.3.t
	desc = sprc.3.d
	picture = GFX_report_event_SPA_civwar2

	fire_only_once = yes

	trigger = {
		tag = SPA
		has_country_flag = SPA_cntfai_will_rise
		OR = {
			165 = { is_owned_and_controlled_by = SPA } #Catalonia
			167 = { is_owned_and_controlled_by = SPA } #Valencia
			166 = { is_owned_and_controlled_by = SPA } #Aragón
			168 = { is_owned_and_controlled_by = SPA } #Murcia
			940 = { is_owned_and_controlled_by = SPA } #Huesca
		}
		NOT = { has_country_flag = election_success }
	}

	mean_time_to_happen = {
		days = 7
	}

	immediate = {
		set_country_flag = SPA_carlists_will_rise
		hidden_effect = {
			SWF = {
				load_oob = SWF_naval
				transfer_technology_without_doctrines = yes
			}
			every_state = {
				limit = {
					OR = {
						is_core_of = SPA
						is_core_of = SPR
					}
				}
				add_claim_by = SWF
			}
			every_owned_state = {
				limit = {
					is_controlled_by = ROOT
					OR = {
						state = 165 #Catalonia
						state = 167 #Valencia
						state = 166 #Aragón
						state = 168 #Murcia
						state = 940
					}
				}
				remove_claim_by = SWF
				add_core_of = SWF
				teleport_armies = {
					to_state_array = core_states
				}
				SWF = {
					transfer_state = PREV
				}
				remove_core_of = SPA
				add_claim_by = SPA
			}
			if = {
				limit = { has_idea = SPA_black_monday }
				SWF = { add_ideas = SPA_black_monday }
			}
			if = {
				limit = { has_idea = SPA_social_breakdown }
				SWF = { add_ideas = SPA_social_breakdown }
			}
			if = {
				limit = { has_idea = SPA_social_breakdown_2 }
				SWF = { add_ideas = SPA_social_breakdown_2 }
			}
			if = {
				limit = { has_idea = SPA_social_breakdown_3 }
				SWF = { add_ideas = SPA_social_breakdown_3 }
			}
		}
	}

	option = {
		name = sprc.3.a #We shall fight to stop this revolution!
		if = {
			limit = { is_ai = yes }
			hidden_effect = {
				if = {
					limit = {
						NOT = { has_template = "Guardias de Reserva" }
					}
					division_template = {
						name = "Guardias de Reserva"
						division_names_group = SPA_INF_01
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 0 y = 2 }
							infantry = { x = 1 y = 0 }
							infantry = { x = 1 y = 1 }
							infantry = { x = 1 y = 2 }
							infantry = { x = 2 y = 0 }
							infantry = { x = 2 y = 1 }
							infantry = { x = 2 y = 2 }
						}
						support = {
							artillery = { x = 0 y = 0 }
						}
					}
				}
				169 = {
					create_unit = {
						division = "name = \"Falange de Madrid\" division_template = \"Guardias de Reserva\" start_experience_factor = 0 start_equipment_factor = 1.0"
						owner = SPA
						prioritize_location = 7183
					}
				}
			}
		}
		SWF = {
			country_event = {
				id = sprc.4
				days = 7
			}
		}
	}
	option = {
		name = sprc.3.b #Viva la Revolución! (Play as the CNT-FAI)
		ai_chance = { base = 0 }
		hidden_effect = {
			if = {
				limit = {
					NOT = { has_template = "Guardias de Reserva" }
				}
				division_template = {
					name = "Guardias de Reserva"
					division_names_group = SPA_INF_01
					regiments = {
						infantry = { x = 0 y = 0 }
						infantry = { x = 0 y = 1 }
						infantry = { x = 0 y = 2 }
						infantry = { x = 1 y = 0 }
						infantry = { x = 1 y = 1 }
						infantry = { x = 1 y = 2 }
						infantry = { x = 2 y = 0 }
						infantry = { x = 2 y = 1 }
						infantry = { x = 2 y = 2 }
					}
					support = {
						artillery = { x = 0 y = 0 }
					}
				}
			}
			169 = {
				create_unit = {
					division = "name = \"Falange de Sevilla\" division_template = \"Guardias de Reserva\" start_experience_factor = 0 start_equipment_factor = 1.0"
					owner = SPA
					prioritize_location = 7183
				}
			}
		}
		SWF = {
			country_event = {
				id = sprc.4
				days = 7
			}
			change_tag_from = SPA
		}
	}
}

# CNT-FAI boot event
country_event = {
	id = sprc.4
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.4 FROM = [From.GetName]" }
	title = sprc.4.t
	desc = sprc.4.d
	picture = GFX_report_event_SPA_civwar2

	is_triggered_only = yes

	option = {
		name = sprc.4.a
		hidden_effect = {
			load_oob = "SCW_SWF"
			FRA = {
				country_event = {
					id = comfrance.22
					days = 3
					random = 72
				}
			}
		}
		if = {
			limit = {
				is_ai = yes
				OR = {
					SPA = {
						is_ai = no
					}
					SPR = {
						is_ai = no
					}
				}
			}
			hidden_effect = {
				load_oob = SCW_SWF_reinforce1
			}
		}
		set_global_flag = spanish_civil_war
		add_equipment_to_stockpile = {
			type = infantry_equipment_1
			amount = 2000
			producer = FRA
		}
		add_opinion_modifier = {
			target = ITA
			modifier = against_us_civil_war_2
		}
		reverse_add_opinion_modifier = {
			target = ITA
			modifier = against_cntfai_2
		}
		add_opinion_modifier = {
			target = GER
			modifier = against_us_civil_war_1
		}
		reverse_add_opinion_modifier = {
			target = GER
			modifier = against_cntfai_1
		}
		add_opinion_modifier = {
			target = FRA
			modifier = supports_us_civil_war_2
		}
		add_opinion_modifier = {
			target = ENG
			modifier = supports_us_civil_war_1
		}
		add_opinion_modifier = {
			target = SRI
			modifier = supports_us_civil_war_1
		}
		country_event = { id = sprc.207 days = 7 random_days = 8 }
		country_event = { id = sprc.208 days = 15 random_days = 15 }
		if = {
			limit = {
				owns_state = 165
			}
			set_capital = { state = 165 }
		}
		declare_war_on = {
			target = SPA
			type = annex_everything
		}
		add_civil_war_target = SPA
		if = {
			limit = { can_declare_war_on = SPR }
			declare_war_on = {
				target = SPR
				type = annex_everything
			}
			add_civil_war_target = SPR
			SPA = {
				add_named_threat = {
					threat = 5
					name = SPA_civil_war_threat
				}
			}
			hidden_effect = {
				news_event = { id = sprc.400 days = 1 }
			}
		}
		add_ideas = extensive_conscription
		add_ideas = SWF_rally_anarchists_idea
	}
}

# We need equipment
country_event = {
	id = sprc.5
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.5 FROM = [From.GetName]" }
	title = sprc.5.t
	desc = sprc.5.d
	picture = GFX_report_event_SPA_civwar2

	trigger = {
		OR = {
			tag = SPA
			tag = SWF
			tag = SPR
		}
		has_global_flag = spanish_civil_war
		has_equipment = { infantry_equipment < 250 }
		has_political_power > -1000
		NOT = {
			has_country_flag = SCW_received_equip
			has_country_flag = SCW_no_equip_thanks
		}
	}

	mean_time_to_happen = {
		days = 15
		modifier = {
			factor = 0.5
			surrender_progress > 0.5
		}
	}

	immediate = {
		set_country_flag = { flag = SCW_received_equip days = 30 value = 1 }
	}

	option = {
		name = sprc.5.a # Yes, we need those guns!
		add_political_power = -100
		if = {
			limit = { tag = SWF }
			add_equipment_to_stockpile = {
				type = infantry_equipment_1
				amount = 1500
				producer = FRA
			}
		}
		else_if = {
			limit = { tag = SPR }
			add_equipment_to_stockpile = {
				type = infantry_equipment_1
				amount = 1500
				producer = ITA
			}
		}
		else_if = {
			limit = { tag = SPA }
			add_equipment_to_stockpile = {
				type = infantry_equipment_1
				amount = 1500
				producer = GER
			}
		}
	}
	option = {
		name = sprc.5.b # No, let's not mortgage our future just yet
		ai_chance = { base = 0 }
		clr_country_flag = SCW_received_equip
		set_country_flag = { flag = SCW_received_equip days = 90 value = 1 }
	}
	option = {
		name = sprc.5.c # Don't talk to me about buying guns
		ai_chance = { base = 0 }
		set_country_flag = SCW_no_equip_thanks
	}
}

### KINGDOM OF SPAIN EVENTS ###

# events 101-103 removed

# Kingdom of Spain victory event (fired by focus)
country_event = {
	id = sprc.120
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.120 FROM = [From.GetName]" }
	title = sprc.120.t
	desc = sprc.120.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	option = {
		name = sprc.120.a
		add_political_power = 200
		clr_global_flag = spanish_civil_war
		set_country_flag = aftermath_of_the_civil_war
		if = {
			limit = { has_idea = SPA_advisors_germany }
			remove_ideas = SPA_advisors_germany
		}
		if = {
			limit = { has_idea = SPA_advisors_russia }
			remove_ideas = SPA_advisors_russia
		}
		if = {
			limit = { has_idea = SPA_advisors_natfrance }
			remove_ideas = SPA_advisors_natfrance
		}
		hidden_effect = {
			random_other_country = {
				news_event = {
					id = worldnews.86
					days = 1
				}
			}
			country_event = {
				id = sprc.322
				days = 15
				random_days = 15
			}
		}
	}
}

# Terror event
country_event = {
	id = sprc.122
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.122 FROM = [From.GetName]" }
	title = sprc.122.t
	desc = sprc.122.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	trigger = {
		num_occupied_states > 0
	}

	option = {
		name = sprc.122.a
		add_stability = -0.02
	}
}

### CNT-FAI EVENTS ###

# events 204-206 removed

# Mine Workers rise up
country_event = {
	id = sprc.207
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.207 FROM = [From.GetName]" }
	title = sprc.207.t
	desc = sprc.207.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	trigger = {
		controls_state = 165
		has_war_with = SPA
		SPA = { has_country_flag = SPA_cntfai_plan_south }
	}

	option = {
		name = sprc.207.a
		custom_effect_tooltip = SPA_workers_rise
		hidden_effect = {
			load_oob = SCW_SWF_workers
		}
	}
}

# Foreign units return
country_event = {
	id = sprc.208
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.208 FROM = [From.GetName]" }
	title = sprc.208.t
	desc = sprc.208.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	trigger = {
		controls_state = 165
		has_war_with = SPA
		has_variable = SWF_foreign_support
	}

	option = {
		name = sprc.207.a
		custom_effect_tooltip = SPA_foreign_unit_arrives
		hidden_effect = {
			load_oob = SCW_SWF_foreign
		}
	}
}

# Madrid is taken by CNT
country_event = {
	id = sprc.211
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.211 FROM = [From.GetName]" }
	title = sprc.211.t
	desc = sprc.211.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	trigger = {
		has_global_flag = spanish_civil_war
		NOT = { owns_state = 41 } #Madrid
	}

	option = {
		name = sprc.211.a #We must scavenge what we can!
		ai_chance = {
			base = 65
		}
		add_political_power = -50
		add_equipment_to_stockpile = {
			type = infantry_equipment
			amount = 1000
			producer = SPA
		}
		41 = {
			damage_building = {
				type = industrial_complex
				damage = 1
			}
			damage_building = {
				type = arms_factory
				damage = 1
			}
		}
	}
	option = {
		name = sprc.211.b #Leave the city as it stands
		ai_chance = {
			base = 35
		}
		add_political_power = 50
	}
}

# CNT victory event
country_event = {
	id = sprc.220
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.220 FROM = [From.GetName]" }
	title = sprc.220.t
	desc = sprc.220.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	option = {
		name = sprc.220.a
		drop_cosmetic_tag = yes
		add_political_power = 200
		clr_global_flag = spanish_civil_war
		set_country_flag = aftermath_of_the_civil_war
		if = {
			limit = { has_idea = SWF_advisors_france }
			remove_ideas = SWF_advisors_france
		}
		if = {
			limit = { has_idea = SWF_advisors_england }
			remove_ideas = SWF_advisors_england
		}
		if = {
			limit = { has_idea = SWF_advisors_italysoc }
			remove_ideas = SWF_advisors_italysoc
		}
		add_named_threat = {
			threat = 2
			name = SPA_revolution_threat
		}
		hidden_effect = {
			random_other_country = {
				news_event = {
					id = worldnews.87
					days = 1
				}
			}
			country_event = {
				id = sprc.221
				days = 5
			}
			country_event = {
				id = sprc.322
				days = 15
				random_days = 15
			}
		}
	}
}

# CNT considers moving the capital to Madrid
country_event = {
	id = sprc.221
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.221 FROM = [From.GetName]" }
	title = sprc.221.t
	desc = sprc.221.d
	picture = GFX_report_event_generic_diplomacy4

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = sprc.221.a
		ai_chance = {
			base = 80
		}
		add_political_power = 20
		set_capital = { state = 41 remember_old_capital = no }
		hidden_effect = {
			country_event = {
				id = sprc.255
				days = 1
			}
		}
	}
	option = {
		name = sprc.221.b
		ai_chance = {
			base = 20
		}
		add_political_power = 20
		hidden_effect = {
			country_event = {
				id = sprc.255
				days = 1
			}
		}
	}
}

### ASSASSINATION EVENT CHAIN

# Assassination plot begins
country_event = {
	id = sprc.306
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.306 FROM = [From.GetName]" }
	title = sprc.306.t
	desc = sprc.306.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	trigger = {
		has_war_with = SPA
		SPA = { has_country_leader = { character = SPA_alfonso_de_borbon } }
	}

	option = {
		name = sprc.306.a
		random_list = {
			75 = {
				country_event = { #success
					id = sprc.309
					days = 20
				}
			}
			25 = {
				country_event = { #fails
					id = sprc.307
					days = 20
				}
			}
		}
	}
}

# Assassination plot fails
country_event = {
	id = sprc.307
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.307 FROM = [From.GetName]" }
	title = sprc.307.t
	desc = sprc.307.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	trigger = {
		has_war_with = SPA
		SPA = { has_country_leader = { character = SPA_alfonso_de_borbon } }
	}

	option = {
		name = sprc.307.a
		add_political_power = -100
		hidden_effect = {
			SPA = {
				country_event = sprc.308
			}
		}
	}
}

# Inform Kingdom of Spain that plot failed
country_event = {
	id = sprc.308
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.308 FROM = [From.GetName]" }
	title = sprc.308.t
	desc = sprc.308.d
	picture = GFX_report_event_SPA_civwar3

	is_triggered_only = yes

	option = {
		name = sprc.308.a
		add_political_power = 50
	}
}

# Assassination plot succeeds
country_event = {
	id = sprc.309
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.309 FROM = [From.GetName]" }
	title = sprc.309.t
	desc = sprc.309.d
	picture = GFX_report_event_europe_funeral

	is_triggered_only = yes

	trigger = {
		has_war_with = SPA
		SPA = { has_country_leader = { character = SPA_alfonso_de_borbon } }
	}

	option = {
		name = sprc.309.a
		add_political_power = 100
		hidden_effect = {
			SPA = {
				country_event = sprc.310
			}
		}
	}
}

# Inform Kingdom of Spain that plot succeeded
country_event = {
	id = sprc.310
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.310 FROM = [From.GetName]" }
	title = sprc.310.t
	desc = sprc.310.d
	picture = GFX_report_event_europe_funeral

	is_triggered_only = yes

	trigger = {
		has_war_with = SPR
		has_country_leader = { character = SPA_alfonso_de_borbon }
	}

	option = {
		name = sprc.310.a #Emilio Mola takes control
		ai_chance = {
			base = 50
		}
		add_stability = -0.10
		add_timed_idea = {
			idea = SPA_regent_killed
			days = 90
		}
		retire_character = SPA_juan_de_borbon
		set_politics = {
			ruling_party = paternal_autocrat
		}
		add_popularity = {
			ideology = paternal_autocrat
			popularity = 0.1
		}
		hidden_effect = {
			SWF = {
				country_event = {
					id = sprc.311
					days = 1
				}
			}
		}
	}
	option = {
		name = sprc.310.b #J.M. Gil-Robles Quiñones retains the government
		ai_chance = {
			base = 50
		}
		add_stability = -0.10
		add_timed_idea = {
			idea = SPA_regent_killed
			days = 90
		}
		retire_character = SPA_juan_de_borbon
		promote_character = SPA_gil_robles
		hidden_effect = {
			SWF = {
				country_event = {
					id = sprc.311
					days = 1
				}
			}
		}
	}
}

# CNT informed of the regent's assassination
country_event = {
	id = sprc.311
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.311 FROM = [From.GetName]" }
	title = sprc.311.t
	desc = sprc.311.d
	picture = GFX_report_event_europe_funeral

	is_triggered_only = yes

	option = {
		name = sprc.311.a
	}
}

# Carlist victory event (triggered by focus)
country_event = {
	id = sprc.320
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.320 FROM = [From.GetName]" }
	title = sprc.320.t
	desc = sprc.320.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	option = {
		name = sprc.320.a
		add_political_power = 200
		clr_global_flag = spanish_civil_war
		set_country_flag = aftermath_of_the_civil_war
		set_cosmetic_tag = SPR_kingdom
		if = {
			limit = { has_idea = SPR_advisors_italianfed }
			remove_ideas = SPR_advisors_italianfed
		}
		if = {
			limit = { has_idea = SPR_advisors_austria }
			remove_ideas = SPR_advisors_austria
		}
		if = {
			limit = { has_idea = SPR_advisors_portugal }
			remove_ideas = SPR_advisors_portugal
		}
		if = {
			limit = { has_idea = SPA_advisors_natfrance }
			remove_ideas = SPA_advisors_natfrance
		}
		hidden_effect = {
			country_event = {
				id = sprc.321
				days = 5
			}
			country_event = {
				id = sprc.322
				days = 15
				random_days = 15
			}
			random_other_country = {
				news_event = {
					id = worldnews.88
					days = 1
				}
			}
		}
	}
}

# SPR considers moving the capital to Madrid
country_event = {
	id = sprc.321
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.321 FROM = [From.GetName]" }
	title = sprc.321.t
	desc = sprc.321.d
	picture = GFX_report_event_generic_diplomacy4

	trigger = {
		41 = { is_owned_and_controlled_by = ROOT } #Madrid
	}

	is_triggered_only = yes

	option = {
		name = sprc.321.a
		ai_chance = {
			base = 100
		}
		add_political_power = 20
		set_capital = { state = 41 remember_old_capital = no }
	}
	option = {
		name = sprc.321.b
		ai_chance = {
			base = 0
		}
		add_political_power = 20
	}
}

# The Troubles Continue
country_event = {
	id = sprc.322
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.322 FROM = [From.GetName]" }
	title = sprc.322.t
	desc = sprc.322.d
	picture = GFX_report_event_generic_ruins

	is_triggered_only = yes

	option = {
		name = sprc.322.a
		add_stability = -0.20
		hidden_effect = {
			country_event = {
				id = sprc.323
				days = 90
			}
		}
	}
}

# Recovery event #1
country_event = {
	id = sprc.323
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.323 FROM = [From.GetName]" }
	title = sprc.323.t
	desc = sprc.323.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	option = {
		name = sprc.322.a
		if = {
			limit = {
				has_political_power < -500
			}
			add_political_power = 200
			add_stability = 0.10
		}
		if = {
			limit = {
				has_political_power > -501
				has_political_power < -100
			}
			add_political_power = 100
			add_stability = 0.05
		}
		if = {
			limit = {
				has_political_power > -101
			}
			add_political_power = 50
		}
		hidden_effect = {
			country_event = {
				id = sprc.324
				days = 90
			}
		}
	}
}

# Recovery event #2
country_event = {
	id = sprc.324
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.324 FROM = [From.GetName]" }
	title = sprc.323.t
	desc = sprc.323.d
	picture = GFX_report_event_SPA_civwar

	is_triggered_only = yes

	trigger = {
		has_political_power < 0
	}

	option = {
		name = sprc.322.a
		if = {
			limit = {
				has_political_power < -500
			}
			add_political_power = 200
			add_stability = 0.10
		}
		if = {
			limit = {
				has_political_power > -501
				has_political_power < -100
			}
			add_political_power = 100
			add_stability = 0.05
		}
		if = {
			limit = {
				has_political_power > -101
			}
			add_political_power = 50
		}
		hidden_effect = {
			country_event = {
				id = sprc.324
				days = 90
			}
		}
	}
}

# Seizing Equatorial Guinea
country_event = {
	id = sprc.327
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.327 FROM = [From.GetName]" }
	title = sprc.327.t
	desc = sprc.327.d
	picture = GFX_report_event_generic_ruins

	fire_only_once = yes

	trigger = {
		OR = {
			tag = MAF
			tag = GER
		}
		927 = { is_owned_and_controlled_by = ROOT } #Kamerun
		297 = { is_owned_and_controlled_by = SWF } #Equatorial Guinea
		has_socialist_government = no
	}

	mean_time_to_happen = {
		days = 3
	}

	option = {
		name = sprc.327.a
		add_political_power = 20
		transfer_state = 297
		297 = {
			add_claim_by = SWF
			if = {
				limit = {
					country_exists = SPA
				}
				add_claim_by = SPA
			}
			if = {
				limit = {
					country_exists = SPR
				}
				add_claim_by = SPR
			}
		}
	}
	option = {
		name = sprc.327.b
		ai_chance = { base = 0 }
		add_political_power = -20
	}
}

country_event = { #Damn it CNT-FAI
	id = sprc.255
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.255 FROM = [From.GetName]" }
	title = sprc.255.t
	desc = sprc.255.d

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = sprc.255.a
		add_political_power = 20
		add_manpower = -2000
		set_global_flag = no_more_Andorra
	}

	option = {
		name = sprc.255.b
	}
}

country_event = { #Peace?
	id = sprc.256
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.256 FROM = [From.GetName]" }
	title = sprc.256.t
	desc = sprc.256.d

	fire_only_once = yes
	is_triggered_only = yes

	trigger = {
		NOT = { has_global_flag = no_more_Andorra }
	}

	option = {
		name = sprc.256.a
		add_political_power = 20
	}
}

news_event = { #Spanish Civil War
	id = sprc.400
	immediate = { log = "[GetDateText]: [Root.GetName]: event sprc.400 FROM = [From.GetName]" }
	title = sprc.400.t
	desc = sprc.400.d
	picture = GFX_news_event_SPA_spanish_civil_war

	major = yes
	fire_for_sender = no
	is_triggered_only = yes

	trigger = {
		wants_world_news = yes
	}

	show_major = {
		NOT = {
			tag = SWF
			tag = SPA
			tag = SPR
		}
	}

	option = {
		name = sprc.400.a
		effect_tooltip = {
			add_named_threat = {
				threat = 5
				name = SPA_civil_war_threat
			}
		}
	}
}
